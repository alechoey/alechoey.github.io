(window.mutinyWpJsonp=window.mutinyWpJsonp||[]).push([[6],{105:function(e,t,n){"use strict";n.r(t),n.d(t,"attachEvents",(function(){return C}));var r=n(7),o=n(1),i=n(5),s=n(28),a=n(0),c=n(27);class d{constructor(e,t,n,r){this.record=e,this.userData=t,this.exporter=n,this.element=r,this.attached=!1,this.listener=e=>{},this.logger=new o.a("dom-event")}attachEvent(){if(!this.attached){const e=this.getElement(),{listener_type:t}=this.record;if(t===a.o.PageView)Object(i.f)(this.record,window.location)&&(this.logger.info("Attaching/firing PageView conversion event for",this.record),this.listener(new Event("pageView"))),this.attached=!0;else if(e){const t=this.domEventType();this.logger.info(`Attaching ${t} event to ${this.record.selector}`,e),e.addEventListener(t,this.listener),this.attached=!0}else this.logger.error(`Attempted to attach ${t} event to ${this.record.selector}, but no record exists`)}}teardown(){this.logger.info("Attempting to tear down DOMEvent",this.record);const e=this.getElement();e?(e.removeEventListener(this.record.listener_type,this.listener),this.logger.info(`Removed ${this.record.listener_type} event listener from ${this.record.selector}`),this.attached=!1):this.logger.error("No element to remove listener from",this.record,this.element)}domEventType(){return this.record.listener_type}getElement(){return this.element?this.element:this.record.selector?document.querySelector(this.record.selector):void 0}}var h=class extends d{constructor(e,t,n){super(e,t,n),this.record=e,this.userData=t,this.exporter=n,this.listener=e=>{this.trackConversionEvent(e)},this.trackConversionEvent=e=>{this.logger.info("Running listener for",this.record),this.logger.info("Attached: ",this.attached);const t=e.target,{listener_type:n}=this.record;if(n===a.o.Submit)this.exporter.track(r.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:{}});else if(n===a.o.Click&&t&&"a"===t.tagName.toLowerCase()&&t.href&&"_blank"!==t.target){const n=t.href;Object(c.c)(e,()=>(this.exporter.track(r.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:{}}),this.exporter.forceFlushQueues()),()=>window.location.href=n,5e3)}else this.exporter.track(r.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:{}})}}};class f extends d{constructor(e,t,n){super(e,t,n),this.record=e,this.userData=t,this.exporter=n,this.listener=e=>{const{value:t}=e.target;this.userData.set(this.record.data.store_key,t)}}}const u=e=>e.data.event&&"calendly.event_scheduled"===e.data.event;var l=class extends h{constructor(){super(...arguments),this.listener=e=>{e instanceof MessageEvent&&u(e)&&this.trackConversionEvent(e)}}domEventType(){return"message"}getElement(){return window}},m=n(9);function g(e){window.drift&&window.drift.on&&(window.drift.on("emailCapture",t=>e.track(r.a.Conversion,{formData:Object.assign(Object.assign({},t),{name:"[Drift] Email Captured"})})),window.drift.on("phoneCapture",t=>e.track(r.a.Conversion,{formData:Object.assign(Object.assign({},t),{name:"[Drift] Phone Captured"})})),window.drift.on("scheduling:meetingBooked",t=>e.track(r.a.Conversion,{formData:Object.assign(Object.assign({},t),{name:"[Drift] Meeting Booked"})})))}class v extends h{attachEvent(){window.drift?this.attachDriftListeners():Object(m.e)(window,"drift",this.attachDriftListeners)}teardown(){this.attached=!1}attachDriftListeners(){window.drift&&window.drift.on&&(window.drift.on("emailCapture",e=>this.attached&&this.exporter.track(r.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:e})),window.drift.on("emailCapture",e=>this.attached&&this.exporter.track(r.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:e})),window.drift.on("scheduling:meetingBooked",e=>this.attached&&this.exporter.track(r.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:e})))}}function w(e){return"hsFormCallback"===e.data.type&&"onFormSubmitted"===e.data.eventName}class p extends h{constructor(){super(...arguments),this.listener=e=>{e instanceof MessageEvent&&w(e)&&this.trackConversionEvent(e)}}domEventType(){return"message"}getElement(){return window}}function k(e,t,n){if(e.event_type===a.g.Data)return new f(e,t,n);if(function(e){return e.event_type===a.g.Conversion}(e)){const{listener_type:r}=e;switch(r){case a.o.Calendly:return new l(e,t,n);case a.o.Drift:return new v(e,t,n);case a.o.Hubspot:return new p(e,t,n);default:return new h(e,t,n)}}throw new Error(`Unknown DOMUpdate type '${e}'`)}var _=n(70);function C(e,t){const n=new o.a("entry"),a=Object(i.c)(e.dom_events,t.preview);var d;a.length>0?n.info("DOM Events:",a):n.info("No DOM Events to attach"),e.config.track_calendly&&(d=t.exporter,window.addEventListener("message",e=>{if(u(e)){const{hostname:e,pathname:t}=window.location;d.track(r.a.Conversion,{formData:{name:`[Calendly] Meeting Booked (${e}${t})`}})}})),e.config.track_drift&&function(e){window.drift?g(e):Object(m.e)(window,"drift",()=>g(e))}(t.exporter),e.config.track_hubspot&&function(e){window.addEventListener("message",t=>{w(t)&&e.track(r.a.Conversion,{formData:{name:"[HubSpot] Form Submitted"}})})}(t.exporter);const h=new s.a(!1,[],a.map(e=>k(e,t.userDataStore.getWriteableStore(),t.exporter)));if(h.onRender(()=>Object(_.a)(e,t.visitorToken)),e.config.track_forms){n.info("Attaching intercepting form listener to all forms on the page");const{href:o}=window.location;if(!e.config.track_forms_url_regex||o.match(e.config.track_forms_url_regex)){const e=function(e){return t=>{const{hostname:n,pathname:o}=window.location,i=t.defaultPrevented;t.preventDefault(),Object(c.c)(t,()=>e.track(r.a.Conversion,{formData:{name:`Form submitted on ${n}${o}`}}),()=>{e.forceFlushQueues(),i||t.target.submit()},750)}}(t.exporter);h.onRender(()=>{document.querySelectorAll("form").forEach(t=>{t.removeEventListener("submit",e),t.addEventListener("submit",e)})})}}h.renderAsync()}},70:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(1),o=n(4),i=n(6),s=n(5);function a(e,t){const n=new r.a("cross-domain-tracker"),{tracked_domains:i}=e.config;n.info("Checking to attach for",i),i&&(n.info("Queuing timeout",i),setTimeout(()=>{n.info("Attaching cross domain tracker"),Array.prototype.slice.call(document.querySelectorAll("a")).forEach(r=>{c(e.config,r.href,r.search,t)&&(n.info("Adding param to",r),r.href=Object(s.a)(r.href,o.j,t))})},0))}function c(e,t,n,r){const{tracked_domains:o}=e;return!!o&&Object(i.b)(o,e=>{const{_mv:o}=Object(s.g)(n);return t.includes(e)&&!window.location.href.includes(e)&&o!==r})}}}]);