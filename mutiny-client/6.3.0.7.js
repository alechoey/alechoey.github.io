(window.mutinyWpJsonp=window.mutinyWpJsonp||[]).push([[6],{107:function(e,t,r){"use strict";r.r(t),r.d(t,"attachEvents",(function(){return A}));var n=r(7),o=r(1),a=r(5),i=r(28),s=r(27),c=r(0);var d=class{constructor(e,t){this.record=e,this.exporter=t,this.attached=!1,this.logger=new o.a("dom-event")}setup(){this.shouldAttach()&&(this.attach(),this.attached=!0)}teardown(){if(this.logger.info("Attempting to tear down DomEvent",this.record),this.detach())return this.logger.info(`Removed ${this.record.listener_type} event listener from ${this.record.selector}`),void(this.attached=!1);this.logger.debug("Could not detach DOM event "+this.record)}};var h=class extends d{constructor(e,t,r){super(e,t),this.record=e,this.exporter=t,this.logger=new o.a("dom-event"),this.element=r||(e.selector?document.querySelector(e.selector):null)}attach(){var e;if(this.attached)return void this.logger.error("Attempted to attach DomEvent that already had .attach called on it",this.record);const{selector:t}=this.record,r=this.listenerType();this.element?this.shouldAttach()&&(null===(e=this.element)||void 0===e||e.addEventListener(r,this.listener.bind(this)),this.attached=!0):this.logger.error(`Attempted to attach ${r} event to ${t}, but no record exists`)}shouldAttach(){return!!this.element||(this.logger.info("Attempted to attach listener but could not find target element",this.record),!1)}listenerType(){return this.record.listener_type}detach(){return this.element?(this.element.removeEventListener(this.record.listener_type,this.listener),!0):(this.logger.error("No element to remove listener from",this.record,this.element),!1)}};var u=class extends h{constructor(e,t,r){super(e,t,r),this.record=e}listener(e){const{conversion_configuration_id:t}=this.record;this.exporter.track(n.a.Conversion,{conversionConfigurationId:t,formData:{}})}};var l=class extends h{constructor(e,t,r,n){super(e,t,n),this.record=e,this.userData=r,this.listener=e=>{const{value:t}=e.target;this.userData.set(this.record.data.store_key,t)}}shouldAttach(){return!0}};const f=e=>e.data.event&&"calendly.event_scheduled"===e.data.event;var m=class extends u{constructor(){super(...arguments),this.listener=e=>{e instanceof MessageEvent&&f(e)&&super.listener(e)}}listenerType(){return"message"}getElement(){return window}},g=r(71),v=r(21),p=r(9);const w=new o.a("drift-tracking"),b=e=>{window.drift?window.drift.on(g.a.Ready,()=>{var t,r,n;null===(t=window.drift)||void 0===t||t.on(g.a.EmailCaptured,t=>Object(v.a)(e,g.a.EmailCaptured,t)),null===(r=window.drift)||void 0===r||r.on(g.a.PhoneCaptured,Object(v.a)(e,g.a.PhoneCaptured)),null===(n=window.drift)||void 0===n||n.on(g.a.MeetingBooked,Object(v.a)(e,g.a.MeetingBooked))}):w.error("Drift is not available when trying to attach listeners")},k=e=>{window.drift?b((e=>(t,r)=>{switch(t){case g.a.EmailCaptured:e.track(n.a.Conversion,{formData:Object.assign(Object.assign({},r),{name:"[Drift] Email Captured"})});break;case g.a.PhoneCaptured:e.track(n.a.Conversion,{formData:Object.assign(Object.assign({},r),{name:"[Drift] Phone Captured"})});break;case g.a.MeetingBooked:e.track(n.a.Conversion,{formData:Object.assign(Object.assign({},r),{name:"[Drift] Meeting Booked"})})}})(e)):Object(p.e)(window,"drift",()=>k(e))};class C extends d{constructor(e,t){super(e,t),this.record=e,this.listener=(e,t)=>{this.attached&&this.exporter.track(n.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:t})}}attach(){b(this.listener)}shouldAttach(){return!0}detach(){return!0}}function y(e){return"hsFormCallback"===e.data.type&&"onFormSubmitted"===e.data.eventName}class _ extends u{constructor(){super(...arguments),this.listener=e=>{e instanceof MessageEvent&&y(e)&&this.listener(e)}}listenerType(){return"message"}getElement(){return window}}var D=r(43);var O=class extends u{listener(e){const{conversion_configuration_id:t}=this.record,{target:r}=e;if(r&&r instanceof HTMLAnchorElement&&"_blank"!==r.target&&!Object(a.f)(Object(a.g)(r.href),window.location)){const{href:o}=r;Object(s.c)(e,()=>(this.exporter.track(n.a.Conversion,{conversionConfigurationId:t,formData:{}}),this.exporter.forceFlushQueues()),()=>Object(D.a)(o),5e3)}else super.listener(e)}};var x=class extends d{constructor(e,t){super(e,t),this.record=e}attach(){const{conversion_configuration_id:e}=this.record;this.exporter.track(n.a.Conversion,{conversionConfigurationId:e,formData:{}})}shouldAttach(){return Object(a.f)(this.record,window.location)}detach(){return!0}};var E=(e,t,r)=>{if(e.event_type===c.g.Data)return new l(e,r,t);if((e=>e.event_type===c.g.Conversion)(e)){const{listener_type:t}=e;switch(t){case c.o.PageView:return new x(e,r);case c.o.Click:return new O(e,r);case c.o.Calendly:return new m(e,r);case c.o.Drift:return new C(e,r);case c.o.Hubspot:return new _(e,r);default:return new u(e,r)}}throw new Error(`Unknown DOMUpdate type '${e}'`)},j=r(72);const A=(e,t)=>{const r=new o.a("entry"),c=Object(a.c)(e.dom_events,t.preview);var d;c.length>0?r.info("DOM Events:",c):r.info("No DOM Events to attach"),e.config.track_calendly&&(d=t.exporter,window.addEventListener("message",e=>{if(f(e)){const{hostname:e,pathname:t}=window.location;d.track(n.a.Conversion,{formData:{name:`[Calendly] Meeting Booked (${e}${t})`}})}})),e.config.track_drift&&k(t.exporter),e.config.track_hubspot&&function(e){window.addEventListener("message",t=>{y(t)&&e.track(n.a.Conversion,{formData:{name:"[HubSpot] Form Submitted"}})})}(t.exporter);const h=new i.a(!1,[],c.map(e=>E(e,t.userDataStore.getWriteableStore(),t.exporter)));if(h.onRender(()=>Object(j.a)(e,t.visitorToken)),e.config.track_forms){r.info("Attaching intercepting form listener to all forms on the page");const{href:o}=window.location;if(!e.config.track_forms_url_regex||new RegExp(e.config.track_forms_url_regex).test(o)){const e=(e=>t=>{const{hostname:r,pathname:o}=window.location,a=t.defaultPrevented;t.preventDefault(),Object(s.c)(t,()=>e.track(n.a.Conversion,{formData:{name:`Form submitted on ${r}${o}`}}),()=>{e.forceFlushQueues(),a||t.target.submit()},750)})(t.exporter);h.onRender(()=>{for(const t of Array.from(document.querySelectorAll("form")))t.removeEventListener("submit",e),t.addEventListener("submit",e)})}}h.renderAsync()}},71:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.Ready="ready",e.EmailCaptured="emailCapture",e.PhoneCaptured="phoneCapture",e.MeetingBooked="scheduling:meetingBooked"}(n||(n={}))},72:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));var n=r(1),o=r(4),a=r(6),i=r(5);function s(e,t){const r=new n.a("cross-domain-tracker"),{tracked_domains:a}=e.config;r.info("Checking to attach for",a),a&&(r.info("Queuing timeout",a),setTimeout(()=>{r.info("Attaching cross domain tracker"),Array.prototype.slice.call(document.querySelectorAll("a")).forEach(n=>{c(e.config,n.href,n.search,t)&&(r.info("Adding param to",n),n.href=Object(i.a)(n.href,o.j,t))})},0))}function c(e,t,r,n){const{tracked_domains:o}=e;return!!o&&Object(a.b)(o,e=>{const{_mv:o}=Object(i.h)(r);return t.includes(e)&&!window.location.href.includes(e)&&o!==n})}}}]);