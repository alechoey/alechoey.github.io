!function(e){function t(t){for(var n,i,o=t[0],s=t[1],a=0,l=[];a<o.length;a++)i=o[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&l.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(c&&c(t);l.length;)l.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=o);var s,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+"mutiny-client/editor/"+e+".4.13.8-hackathon.js"}(e);var c=new Error;s=function(t){a.onerror=a.onload=null,clearTimeout(l);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",c.name="ChunkLoadError",c.type=i,c.request=o,n[1](c)}r[e]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:a})}),12e4);a.onerror=a.onload=s,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var o=window.mutinyDevelopmentWpJsonp=window.mutinyDevelopmentWpJsonp||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var a=0;a<o.length;a++)t(o[a]);var c=s;i(i.s=39)}([function(e,t,n){"use strict";var r,i,o,s,a,c,l,u,d,h,f,p,m,g,v,y,b,w,E,k,_,O,C,x,S,T,A,M,j;n.d(t,"s",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"m",(function(){return s})),n.d(t,"x",(function(){return a})),n.d(t,"r",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"u",(function(){return p})),n.d(t,"t",(function(){return m})),n.d(t,"k",(function(){return g})),n.d(t,"q",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"i",(function(){return w})),n.d(t,"w",(function(){return E})),n.d(t,"o",(function(){return k})),n.d(t,"g",(function(){return _})),n.d(t,"v",(function(){return O})),n.d(t,"j",(function(){return C})),n.d(t,"f",(function(){return x})),n.d(t,"p",(function(){return S})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return j})),function(e){e.Editor="editor",e.Preview="preview",e.Live="live"}(r||(r={})),function(e){e.LiveOverrideMode="LiveOverrideMode",e.Live="Live",e.LocalDebug="LocalDebug",e.Preview="Preview"}(i||(i={})),function(e){e.StateChange="mutiny:state-change",e.ImpressionCacheUpdate="mutiny:impression-cache:update",e.AssetViewerLoaded="mutiny:asset-viewer:loaded",e.AssetViewerOpened="mutiny:asset-viewer:opened",e.WindowExperienceImpression="mutiny:experience-impression",e.ExperienceRenderComplete="mutiny:renderExperience:complete",e.DomRendererComplete="mutiny:dom-renderer:complete"}(o||(o={})),function(e){e.Mutiny="mutiny",e.Window="window",e.Segment="segment",e.Amplitude="amplitude",e.Cookie="cookie",e.Drawbridge="drawbridge",e.GoogleAnalytics="google_analytics",e.GoogleAnalytics4="google_analytics_4",e.GoogleTagManager="google_tag_manager",e.Marketo="marketo",e.Hubspot="hubspot",e.MutinyTrackedLink="mutiny_tracked_link"}(s||(s={})),function(e){e.Marketo="marketo",e.Hubspot="hubspot",e.MutinyTrackedLink="mutiny_tracked_link"}(a||(a={})),function(e){e.Personalized="personalized",e.Control="control"}(c||(c={})),function(e){e.Data="data",e.Conversion="conversion"}(l||(l={})),function(e){e.Increment="increment",e.Timing="timing",e.Event="event"}(u||(u={})),function(e){e.Change="change",e.Click="click",e.Submit="submit",e.PageView="page_view",e.Calendly="calendly",e.Drift="drift",e.Hubspot="hubspot"}(d||(d={})),function(e){e.Equal="equal",e.NotEqual="not_equal",e.UrlEqual="url_equal",e.UrlNotEqual="url_not_equal",e.GreaterThan="greater_than",e.GreaterThanOrEqual="greater_than_or_equal",e.LessThan="less_than",e.LessThanOrEqual="less_than_or_equal",e.Includes="includes",e.NotIncludes="not_includes",e.StartsWith="starts_with",e.EndsWith="ends_with",e.MatchesRegex="matches_regex",e.UrlHostEqual="url_host_equal",e.UrlHostNotEqual="url_host_not_equal",e.UrlPathEqual="url_path_equal",e.UrlPathNotEqual="url_path_not_equal"}(h||(h={})),function(e){e.Count="_count"}(f||(f={})),function(e){e.FAB="fab",e.Modal="modal",e.TopBar="top_bar",e.ExitIntentModal="exit_intent_modal",e.ContentPlaylist="content_playlist"}(p||(p={})),function(e){e.MultipleChoice="multiple_choice",e.Form="form"}(m||(m={})),function(e){e.QuestionnaireClicked="questionnaire_clicked",e.QuestionnaireDismissed="questionnaire_dismissed",e.QuestionnaireAnswered="questionnaire_answered",e.QuestionnaireFormSubmitted="questionnaire_form_submitted",e.QuestionnaireCtaClicked="questionnaire_cta_clicked",e.ContentPlaylistAssetViewed="content_playlist_asset_viewed",e.ContentPlaylistAssetConsumed="content_playlist_asset_consumed"}(g||(g={})),function(e){e.Data="data",e.Link="link",e.Dismiss="dismiss",e.Input="input"}(v||(v={})),function(e){e.Text="text",e.Email="email"}(y||(y={})),function(e){e.Modal="modal",e.Page="page"}(b||(b={})),function(e){e.Redirect="redirect",e.Render="render",e.Questionnaire="questionnaire",e.Headless="headless",e.Block="block"}(w||(w={})),function(e){e.Mouseout="mouseout",e.TimeOnPage="time_on_page",e.Scroll="scroll"}(E||(E={})),function(e){e.Compact="compact",e.Icon="icon",e.Hero="hero",e.None="none"}(k||(k={})),function(e){e.Top="top",e.Bottom="bottom"}(_||(_={})),function(e){e.Light="light",e.Dark="dark"}(O||(O={})),function(e){e.Colfax="colfax",e.Futura="furtura",e.SystemDefault="system_default"}(C||(C={})),function(e){e.SameTab="same_tab",e.NewTab="new_tab"}(x||(x={})),function(e){e.Back="back",e.Forward="forward"}(S||(S={})),function(e){e.Default="default",e.AssetViewer="asset_viewer"}(T||(T={})),function(e){e.Primary="primary",e.Secondary="secondary",e.Tertiary="tertiary",e.Transparent="transparent",e.TransparentSecondary="transparent_secondary",e.Translucent="translucent"}(A||(A={})),function(e){e.Modal="modal",e.Banner="banner",e.Sidepop="sidepop",e.Brand="brand"}(M||(M={})),function(e){e.Global="global",e.PerSegment="per_segment",e.PerExperience="per_experience"}(j||(j={}))},function(e,t,n){"use strict";var r=n(12);const i=0,o=1,s=2,a=3,c=4;t.a=class{constructor(e){this.prefix=e,this.logger()}debug(...e){this.logger().then(t=>{this.logLevel()>c&&t.extend("debug")(...e)})}log(...e){this.logger().then(t=>{this.logLevel()>a&&t.extend("log")(...e)})}info(...e){this.logger().then(t=>{this.logLevel()>s&&t.extend("info")(...e)})}warn(...e){this.logger().then(t=>{this.logLevel()>o&&t.extend("warn")(...e)})}error(...e){this.logger().then(t=>{this.logLevel()>i&&t.extend("error")(...e)})}logger(){return this._logger?Promise.resolve(this._logger):n.e(2).then(n.t.bind(null,41,7)).then(e=>e.default).then(e=>this._logger=e("mutiny:"+this.prefix))}logLevel(){const e=Object(r.a)().getItem("debugLevel");return e?Number(e):4}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m}));var r=n(15),i=n.n(r),o=n(1),s=n(26),a=n.n(s),c=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};let l;function u(){return c(this,void 0,void 0,(function*(){return l||(l=(()=>c(this,void 0,void 0,(function*(){const{default:e}=yield n.e(3).then(n.t.bind(null,40,7));return e({apiKey:"fake-key",autoCaptureSessions:!1,autoNotify:!1,consoleBreadcrumbsEnabled:!1,logger:null,appVersion:a.a})})))(),l)}))}const d=new o.a("error-handler");const h={notify:(e,t)=>c(void 0,void 0,void 0,(function*(){const n=yield u(),r=function(e){return e instanceof Error?e.message:"string"==typeof e?e:void 0}(e);null==n||n.notify(e,Object.assign(Object.assign({},r?{context:r}:{}),t))})),leaveBreadcrumb:(...e)=>c(void 0,void 0,void 0,(function*(){const t=yield u();null==t||t.leaveBreadcrumb(...e)}))};t.b=h;const f=e=>c(void 0,void 0,void 0,(function*(){const t=yield u();t&&(t.metaData=i()(t.metaData,e))}));function p(e){try{return e()}catch(e){throw d.error("Error thrown:",e),e}}const m=e=>(...t)=>p(()=>e(...t))},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"a",(function(){return m}));var r=n(2),i=n(14),o=n(19),s=(n(0),n(10)),a=n(9);function c(e,t){return e.replace(/\/$/,"")===t.replace(/\/$/,"")}function l(e){try{return decodeURIComponent(e.replace(/\+/g,"%20"))}catch(t){if(t instanceof URIError)return e;throw t}}const u=e=>{if("string"!=typeof e||0===e.length)return{hash:"",hostname:"",pathname:"",url_host:"",url_path:"",search:""};const t=Object(s.a)("a");return t.href=e.startsWith("http")?e:"https://"+e,{hash:t.hash,hostname:t.hostname,pathname:t.pathname,url_host:t.hostname,url_path:t.pathname,search:t.search}};function d(e,t){const n=e.toLowerCase(),r=(i=n,i.slice(Math.max(0,i.lastIndexOf(".",i.lastIndexOf(".")-1)+1))).toLowerCase();var i;const o="www."+r,s=t.toLowerCase();return n===o||n===r?s===o||s===r:n===s}function h(e){return e.replace("?","").split("&").reduce((e,t)=>{const[n,r]=t.split("="),i=n.split(".");return i.reduce((e,t,n)=>function(e,t){return"__proto__"===t||function(e,t){try{return t in e}catch(e){return!1}}(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}(e,t)?{}:(n===i.length-1?e[t]="string"==typeof r?l(r):r||"":e[t]=e[t]||{},e[t]),e),e},{})}function f(e,t){const n=t.hostname.toLowerCase(),s=t.pathname.toLowerCase(),a=h(t.search.toLowerCase());if(function(e){const t=e;return void 0!==t.url_condition&&null!==t.url_condition}(e))return Object(i.b)(e.url_condition,new o.a({url:t.toString(),url_host:n,url_path:s}));if(function(e){const t=e;return void 0!==t.url_host&&null!==t.url_host&&void 0!==t.url_path&&null!==t.url_path}(e)){const t=e.url_host.toLowerCase(),r=e.url_path.toLowerCase(),i=e.url_query_params,o=d(n,t),h=c(r,s),f=(u=a,!(l=i)||!!u&&Object.entries(l).reduce((e,[t,n])=>{var r;return e&&(null===(r=u[t.toLowerCase()])||void 0===r?void 0:r.toLowerCase())===n.toLowerCase()},!0));return o&&h&&f}var l,u;return r.b.notify("Invalid URL object",{metaData:{urlObject:e}}),!1}const p=(e,t)=>Boolean(f(u(e),u(t)));function m(e,t){return Object(a.d)(t).reduce((e,[t,n])=>null!=n?function(e,t,n){const r=`${t}=${n}`;return e.includes(t+"=")?e.replace(new RegExp(t+"=[^&]*"),r):e.includes("?")?`${e}&${r}`:`${e}?${r}`}(e,t,n):e,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return m}));var r=n(13),i=n(12),o=n(6);const s="mutiny.user.session_number",a="mutiny.user.token",c="mutiny.user.session",{getCookie:l,setCookie:u,isCookieSet:d}=r.a,h=(e,t,n=!1)=>{if(Object(o.d)()&&!o.a.includes(e))return;if(n||!d(e)){const n=new Date;n.setTime(n.getTime()+943488e5),u(e,t,n)}Object(i.a)().setItem(e,t)},f=e=>{const t=l(e);if(t)return t;const n=Object(i.a)().getItem(e);return n&&h(e,n),n},p=(e,t,n)=>{if(Object(o.d)()&&!o.a.includes(e))return;const i=new Date;i.setTime(i.getTime()+n);try{return r.a.setCookie(e,t,i),!0}catch(e){return!1}},m=e=>l(e)},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c}));const r=e=>e,i=(e,t)=>{const n=new Set;return e.filter(e=>{const r=t(e);return!n.has(r)&&(n.add(r),!0)})};function o(e,t=r){for(const n of e)if(t(n))return!0;return!1}function s(e,t=r){for(const n of e)if(!t(n))return!1;return!0}function a(e,t,n){return n.indexOf(e)===t}function c(e){return e.filter(a)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n(13);const i=["mutiny.defaultOptOut","mutiny.optOut","mutiny.optIn"];function o(){const e=e=>Boolean(r.a.getCookie(e));return e("mutiny.optOut")||e("mutiny.defaultOptOut")&&!e("mutiny.optIn")}const s=(()=>{const e=new Date;return e.setTime(e.getTime()+943488e5),e})();function a(){return r.a.setCookie("mutiny.optIn","",s),r.a.setCookie("mutiny.optOut","true",s)}function c(){return r.a.setCookie("mutiny.optOut","",s),r.a.setCookie("mutiny.optIn","true",s)}function l(){return r.a.setCookie("mutiny.defaultOptOut","true",s)}function u(){if(o())return!0;const e=void 0!==navigator.doNotTrack?navigator.doNotTrack:void 0!==window.doNotTrack?window.doNotTrack:void 0!==navigator.msDoNotTrack?navigator.msDoNotTrack:null;return 0!==Number.parseInt(null!=e?e:"",10)&&"no"!==e&&(1===Number.parseInt(null!=e?e:"",10)||"yes"===e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return a}));const r=new RegExp(/{{\s*([\w.]+)\s*}}/,"g");function i(e,t){return e.replace(r,(e,n)=>{const r=t.get(n);return null===r?"":r.toString()})}function o(e,t){return Array.isArray(e)?e.map(e=>o(e,t)):"string"==typeof e?i(e,t):"object"!=typeof e||void 0===e||null==e?e:Object.keys(e).reduce((n,r)=>(n[r]=o(e[r],t),n),{})}function s(e){const[t,n]=e.split("[].",2);return{nestedPath:n||null,topLevelPath:t}}function a(e){var t;let n=0;if(0===e.length)return n;for(let r=0;r<e.length;r++){n=(n<<5)-n+(null!==(t=e.codePointAt(r))&&void 0!==t?t:0),n&=n}return n}},function(e,t,n){"use strict";n.d(t,"i",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return w})),n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return k})),n.d(t,"e",(function(){return _})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return x}));var r=n(15),i=n.n(r),o=n(21),s=n(5),a=n(9),c=n(18),l=n(0),u=n(42),d=n(4),h=n(6);const f="_mv",p="_ms";let m;class g{constructor(e=new URLSearchParams(window.location.search)){this.queryParams=e}static get instance(){return null!=m?m:m=new this}getIsNewVisitor(){const e=Object(d.e)(d.c)||Object(d.e)("_immortal|mutiny.user.token");return!(this.queryParams.has(f)||e&&"null"!==e)}getVisitorToken(){const e=Object(d.e)(d.c)||Object(d.e)("_immortal|mutiny.user.token"),t=this.queryParams.get(f)||e||Object(u.a)();return this.getIsNewVisitor()&&!Object(h.c)()&&Object(d.g)(d.c,t),t}setVisitorToken(e){Object(h.c)()||Object(d.g)(d.c,e)}getIsNewSession(){const e=Object(d.d)(d.b);return!(this.queryParams.has(p)||e&&"null"!==e)}getSessionToken(){const e=Object(d.d)(d.b),t=this.queryParams.get(p)||e||Object(u.a)();return this.getIsNewSession()&&!Object(h.c)()&&Object(d.f)(d.b,t,18e5),t}setSessionToken(e){Object(h.c)()||Object(d.f)(d.b,e,18e5)}}var v=n(12),y=n(23);const b="_mcm",w="mutiny_experience_override",E="mutiny_variation_override",k="mutiny_highlight",_="personalize.override",O="user.personalize_weight";var C;!function(e){e.Impression="impression",e.QuestionnaireImpression="questionnaireImpression"}(C||(C={}));class x{constructor(e,t){this.events=t;const n={device_type:Object(o.a)(),referrer:document.referrer,user_agent:navigator.userAgent};this.data=i()({browser:n},e),this.listeners=[]}getWriteableStore(){return new S(this.data,this.listeners,this.events)}get(e){const t=Object(a.c)(this.data,e);return null===t?Object(y.a)().getItem(e)||Object(v.a)().getItem(e):t}onChange(e){this.listeners.push(e)}merge(e){return this.data=i()(this.data,e),this}toJSON(){return JSON.parse(JSON.stringify(this.data))}}class S extends x{constructor(e,t=[],n=new c.a){super(e,n),this.events=n,this.listeners=t,this.events.on(l.h.ImpressionCacheUpdate,({detail:e})=>{e.impression&&this.updateImpressionCache(e.impression,C.Impression),e.questionnaireImpression&&this.updateImpressionCache(e.questionnaireImpression,C.QuestionnaireImpression),e.sessionNumber&&this.setBulk({person:{behavior:{session_number:e.sessionNumber}}})})}setBulk(e){const t=i()(Object(a.c)(this.data,"person.behavior")||{},Object(a.c)(e,"person.behavior")||{},{arrayMerge:this.behavioralArrayMerge});this.data=i()(i()(this.data,e),{person:{behavior:t}},{arrayMerge:(e,t)=>t})}getData(){return this.data}set(e,t,{localStorage:n=!0}={}){const r=e.split("."),i=Object.assign({},this.data);return r.reduce((e,n,i)=>(i===r.length-1?e[n]=t:void 0===e[n]&&(e[n]={}),e[n]),i),this.data=i,n&&Object(v.a)().setItem(e,t),this.triggerListeners(e,t),this}getSessionToken(){const e=this.get("query."+p);return(null==e?void 0:e.length)?e:g.instance.getSessionToken()}isNewUser(){return g.instance.getIsNewVisitor()}getUserToken(){const e=this.get("query."+f);return(null==e?void 0:e.length)?e:g.instance.getVisitorToken()}getClientMode(){var e;switch(null===(e=this.get("query."+b))||void 0===e?void 0:e.toLowerCase()){case l.c.AssetViewer:return l.c.AssetViewer;default:return l.c.Default}}behavioralArrayMerge(e,t){const n=[],r=[];for(const e of t)e.token&&e.token.length>0?n.push(e):r.push(e);for(const t of e)t.token&&t.token.length>0?n.push(t):r.push(t);return[...r,...Object(s.d)(n,e=>e.token)]}triggerListeners(e,t){for(const n of this.listeners)n(e,t)}updateImpressionCache(e,t){const[n,r]=this.impressionCacheAttributeKey(t),i=this.get(n)||[],o=[e,...Array.isArray(i)?i:[]].reduce((e,t)=>(e[t.token]?e[t.token]=Object.assign(Object.assign({},e[t.token]),t):e[t.token]=t,e),{}),s=Object(a.e)(o);this.setBulk({person:{behavior:{[r]:s}}})}impressionCacheAttributeKey(e){switch(e){case C.Impression:return["person.behavior.visited_url","visited_url"];case C.QuestionnaireImpression:return["person.behavior.viewed_questionnaires","viewed_questionnaires"]}}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(1),i=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const o=new WeakMap,s=(e,t)=>i(void 0,void 0,void 0,(function*(){var n,s;if(e[t])return e[t];const a=null===(n=o.get(e))||void 0===n?void 0:n.pendingProperties.get(t);if(a)return a;const c=((e,t)=>i(void 0,void 0,void 0,(function*(){return new Promise(n=>{const i=new r.a("on-set-"+t);let s,a=!1;Object.defineProperty(e,t,{configurable:!0,get:()=>s,set:r=>{var c;s=r,a||(i.log("Set",t),null===(c=o.get(e))||void 0===c||c.pendingProperties.delete(t),a=!0,n(s))}})})})))(e,t);return o.has(e)?null===(s=o.get(e))||void 0===s||s.pendingProperties.set(t,c):o.set(e,{pendingProperties:new Map([[t,c]])}),c}));function a(e){return Object.keys(e).reduce((t,n)=>(t.push([n,e[n]]),t),[])}function c(e){return Object.keys(e).reduce((t,n)=>(t.push(e[n]),t),[])}function l(e){return null!=e&&e.constructor!==Object}function u(e,t){if(null==e||e.constructor===Object&&0===Object.keys(e).length)return null;if(!t||!e||l(e))return e;if(e&&t in e&&l(e[t]))return e[t];const[n,...r]=t.split(".");return u(e[n],r.join("."))}function d(e){return Object.id(e)}(()=>{if(void 0===Object.id){let e=0;Object.id=t=>(void 0===t.__uniqueid&&Object.defineProperty(t,"__uniqueid",{value:++e,enumerable:!1,writable:!1}),t.__uniqueid)}})()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r=document.createElement;document.createElement=Object.getPrototypeOf(document).createElement,n(29);const i=document.createElement,o=function(...e){return i.call(document,...e)};document.createElement=r},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6);class i{constructor(){this.data={}}getItem(e){return this.data.hasOwnProperty(e)?this.data[e]:null}setItem(e,t){this.data[e]=t}removeItem(e){delete this.data[e]}}let o;function s(){return o||(o=!Object(r.d)()&&function(){try{return localStorage.setItem("test","test"),"test"!==localStorage.getItem("test")?!1:(localStorage.removeItem("test"),!0)}catch(e){return!1}}()?localStorage:new i,o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{static getCookie(e){var t;const n=("; "+document.cookie).split(`; ${e}=`);if(n.length>1)return null===(t=n.pop())||void 0===t?void 0:t.split(";").shift()}static setCookie(e,t,n){r.setTopLevelDomainCookie(e,t,window.location.hostname,n)}static isCookieSet(e){return void 0!==r.getCookie(e)}static tryCookieWrite(e,t){return document.cookie=`${e}=${t}`,r.getCookie(e)===t}static setTopLevelDomainCookie(e,t,n,i){const o=n.split(".");let s=2;for(;s<=o.length;){const n=o.slice(-s).join("."),a=`${t}; expires=${i.toUTCString()}; path=/; domain=.${n}`;if(r.tryCookieWrite(e,a))return;s+=1}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p}));var r=n(2),i=n(19),o=n(0),s=n(5),a=n(9),c=n(7),l=n(3);function u(e,t,n){switch(n){case o.e.Equal:return e===t;case o.e.NotEqual:return e!==t;case o.e.NotIncludes:return!e||!e.includes(t);case o.e.UrlNotEqual:return!e||!Object(l.f)(e,t);case o.e.UrlHostNotEqual:return!e||!Object(l.b)(e,t);case o.e.UrlPathNotEqual:return!e||!Object(l.c)(e,t);default:if(null==e)return!1;switch(n){case o.e.UrlEqual:return Object(l.f)(e,t);case o.e.GreaterThan:return e>t;case o.e.GreaterThanOrEqual:return e>=t;case o.e.LessThan:return e<t;case o.e.LessThanOrEqual:return e<=t;case o.e.Includes:return null==e?void 0:e.includes(t);case o.e.StartsWith:return null==e?void 0:e.startsWith(t);case o.e.EndsWith:return null==e?void 0:e.endsWith(t);case o.e.MatchesRegex:return e&&Boolean(new RegExp(t).test(e));case o.e.UrlHostEqual:return e&&Object(l.b)(e,t);case o.e.UrlPathEqual:return e&&Object(l.c)(e,t)}}}function d(e,t){if(!e||0===Object.keys(e).length)return!0;const n=t(e),r=e.or&&e.or.length>0,i=e.and&&e.and.length>0;if(r&&i){const r=Object(s.b)(e.or,e=>d(e,t)),i=Object(s.a)(e.and,e=>d(e,t));return"and"===e.priority?n&&i||r:(n||r)&&i}return r?n||Object(s.b)(e.or,e=>d(e,t)):i?n&&Object(s.a)(e.and,e=>d(e,t)):n}function h(e,t){const n=e.attribute.includes("query.")&&e.value?Object(l.e)(e.value):e.value,{topLevelPath:d,nestedPath:h}=Object(c.e)(e.attribute);let m=t.get(d);return h?(m=m||[],Array.isArray(m)?function(e,t,n,r,c,l){const d=(c?function(e,t){return e.filter(e=>p(t,new i.a(e)))}(e,c):e).map(e=>Object(a.c)(e,t)),h=e=>u(e,n,r);switch(r){case o.e.Equal:case o.e.UrlEqual:return null==n&&0===d.length||f(d,s.b,h,l);case o.e.GreaterThan:case o.e.GreaterThanOrEqual:case o.e.LessThan:case o.e.LessThanOrEqual:return f(d,s.b,h,l);case o.e.NotEqual:case o.e.UrlNotEqual:return(null!=n||0!==d.length)&&f(d,s.a,h,l);case o.e.Includes:return d.length>0&&f(d,s.b,h,l);case o.e.NotIncludes:return 0===d.length||f(d,s.a,h,l);default:return!1}}(m,h,n,e.comparator,e.filter,e.aggregation):(r.b.notify("Invalid array condition on ",{metaData:{accessedData:m}}),!1)):u(m,n,e.comparator)}function f(e,t,n,i){return i?d(i,({attribute:t,value:i,comparator:s})=>u(function(e,t){switch(t){case o.d.Count:return e.length;default:return r.b.notify("Unrecognized aggregation attribute",{metaData:{aggregationKey:t}}),null}}(e.filter(n),t),i,s)):t(e,n)}function p(e,t){return d(e,e=>h(e,t))}},function(e,t,n){"use strict";var r=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)};var i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function o(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function s(e,t,n){return e.concat(t).map((function(e){return o(e,n)}))}function a(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function c(e,t){try{return t in e}catch(e){return!1}}function l(e,t,n){var r={};return n.isMergeableObject(e)&&a(e).forEach((function(t){r[t]=o(e[t],n)})),a(t).forEach((function(i){(function(e,t){return c(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(c(e,i)&&n.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"==typeof n?n:u}(i,n)(e[i],t[i],n):r[i]=o(t[i],n))})),r}function u(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||r,n.cloneUnlessOtherwiseSpecified=o;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):l(e,t,n):o(t,n)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var d=u;e.exports=d},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);class i{constructor(){this.logger=new r.a("event-bus")}on(e,t){document.addEventListener(e,t)}off(e,t){document.removeEventListener(e,t)}trigger(e,t={}){this.logger.info(`Dispatching '${e}' event`),document.dispatchEvent(new CustomEvent(e,{detail:t}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);class i{constructor(e){this.data=e}get(e){return Object(r.c)(this.data,e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var r=n(0),i=n(2),o=n(1),s=n(5);class a{constructor(){this.queue=[],this.logger=new o.a("function-queue")}enqueue(e){this.logger.info("Enqueuing function queue item"),this.queue.push(e)}flushAsync(){setTimeout(()=>this.flush(),0)}flush(){const e=[...this.queue];this.queue=[];for(const t of e)this.logger.info("Flushing function queue item"),Object(i.c)(t)}}class c{constructor(e,t=new a){this.isReady=e,this.queue=t,this.retryFlushInterval=250}enqueue(e){this.queue.enqueue(e),this.flush()}flush(){this.isReady()?this.queue.flush():(clearTimeout(this.timeoutHandle),this.timeoutHandle=setTimeout(()=>{this.flush()},this.retryFlushInterval))}flushAsync(){this.flush()}}const l="[Mutiny]";class u{constructor(e,t,n,r){this.visitorToken=e,this.userDataStore=n,this.config=r,this.logger=new o.a("amplitude-adapter"),this.queue=new c(()=>void 0!==this.getAmplitude())}page(){}identify(){this.queue.enqueue(()=>{const e=this.getAmplitude(),{Identify:t}=window.amplitude,n=(new t).set(l+" visitor_id",this.visitorToken);this.logger.info("Calling `identify`"),e.identify(this.config.exposed_user_data_attributes.reduce((e,t)=>e.set(`${l} ${t}`,this.userDataStore.get(t)),n))})}track(e,t){this.queue.enqueue(()=>{switch(e){case K.ExperienceImpression:return this.trackImpression(t);case K.QuestionnaireResponse:return this.trackQuestionnaireResponseSubmission(t);case K.Event:return this.trackEvent(t);default:return}})}trackEvent(e){switch(e.eventType){case r.k.QuestionnaireFormSubmitted:return this.trackQuestionnaireFormSubmission(e)}}trackImpression({experience:e,impressionType:t,audienceSegment:n}){if(n&&(t===r.r.Personalized||t===r.r.Control)){const i=`${e.name}_${n.name}`,o=this.getAmplitude(),{Identify:s}=window.amplitude;return this.logger.info("Calling `amplitude.identify`"),o.identify((new s).set(`${l} ${i}`,t).set(l+" last experience",i)),this.logger.info("Calling `amplitude.logEvent`"),o.logEvent(l+" Experience Viewed",{audienceSegment:null==n?void 0:n.name,experience:null==e?void 0:e.name,personalized:t===r.r.Personalized})}}trackQuestionnaireResponseSubmission({answers:e,questionnaire:t}){const n=this.getAmplitude(),r=e?e.reduce((e,{key:t,value:n})=>Object.assign(Object.assign({},e),{[t]:n}),{}):{};return this.logger.info("Calling `amplitude.logEvent`"),n.logEvent(l+" Questionnaire Completed",Object.assign(Object.assign({},r),{questionnaire:t.key}))}trackQuestionnaireFormSubmission({metadata:{email:e,questionnaire_key:t}}){const n=this.getAmplitude();return this.logger.info("Calling `amplitude.logEvent`"),n.logEvent(l+" Questionnaire Completed",{email:e,questionnaire:t})}getAmplitude(){if(window.amplitude){if("a8750e5a67bafbcd"===this.config.api_key){const e=window.location.pathname.startsWith("/blog");return window.amplitude.getInstance(e?"blog_2.0":"corp_site_2.0")}return window.amplitude.getInstance()}}}var d=n(4);var h=class{constructor(e,t,n,r,i){this.apiClient=i,this.logger=new o.a("hubspot-adapter")}identify(){this.logger.info("Calling `identify`");const e=Object(d.e)("hubspotutk");if(e)return this.apiClient.trackVisitorIdentification({identificationType:r.x.Hubspot,value:e})}page(){}track(e,t){}};var f=class{constructor(e,t,n,r,i){this.apiClient=i,this.logger=new o.a("marketo-adapter")}identify(){this.logger.info("Calling `identify`");const e=Object(d.e)("_mkto_trk");if(e)return this.apiClient.trackVisitorIdentification({identificationType:r.x.Marketo,value:e})}page(){}track(e,t){}},p="URLSearchParams"in self,m="Symbol"in self&&"iterator"in Symbol,g="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),v="FormData"in self,y="ArrayBuffer"in self;if(y)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};function E(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function k(e){return"string"!=typeof e&&(e=String(e)),e}function _(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return m&&(t[Symbol.iterator]=function(){return t}),t}function O(e){this.map={},e instanceof O?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function C(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function x(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function S(e){var t=new FileReader,n=x(t);return t.readAsArrayBuffer(e),n}function T(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function A(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:g&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:v&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:p&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():y&&g&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=T(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y&&(ArrayBuffer.prototype.isPrototypeOf(e)||w(e))?this._bodyArrayBuffer=T(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g&&(this.blob=function(){var e=C(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?C(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(S)}),this.text=function(){var e,t,n,r=C(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=x(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v&&(this.formData=function(){return this.text().then(P)}),this.json=function(){return this.text().then(JSON.parse)},this}O.prototype.append=function(e,t){e=E(e),t=k(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},O.prototype.delete=function(e){delete this.map[E(e)]},O.prototype.get=function(e){return e=E(e),this.has(e)?this.map[e]:null},O.prototype.has=function(e){return this.map.hasOwnProperty(E(e))},O.prototype.set=function(e,t){this.map[E(e)]=k(t)},O.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},O.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),_(e)},O.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),_(e)},O.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),_(e)},m&&(O.prototype[Symbol.iterator]=O.prototype.entries);var M=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function j(e,t){var n,r,i=(t=t||{}).body;if(e instanceof j){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new O(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new O(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),M.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function P(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function N(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new O(t.headers),this.url=t.url||"",this._initBody(e)}j.prototype.clone=function(){return new j(this,{body:this._bodyInit})},A.call(j.prototype),A.call(N.prototype),N.prototype.clone=function(){return new N(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},N.error=function(){var e=new N(null,{status:0,statusText:""});return e.type="error",e};var I=[301,302,303,307,308];N.redirect=function(e,t){if(-1===I.indexOf(t))throw new RangeError("Invalid status code");return new N(null,{status:t,headers:{location:e}})};var z=self.DOMException;try{new z}catch(e){(z=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),z.prototype.constructor=z}function L(e,t){return new Promise((function(n,r){var i=new j(e,t);if(i.signal&&i.signal.aborted)return r(new z("Aborted","AbortError"));var o=new XMLHttpRequest;function s(){o.abort()}o.onload=function(){var e,t,r={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new O,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;n(new N(i,r))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.onabort=function(){r(new z("Aborted","AbortError"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&g&&(o.responseType="blob"),i.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",s),o.onreadystatechange=function(){4===o.readyState&&i.signal.removeEventListener("abort",s)}),o.send(void 0===i._bodyInit?null:i._bodyInit)}))}L.polyfill=!0,self.fetch||(self.fetch=L,self.Headers=O,self.Request=j,self.Response=N);var q=class{constructor(e,t,n,r,i){this.sessionToken=t,this.store=n,this.config=r,this.apiClient=i}identify(){}page(){return this.apiClient.trackImpression(this.sessionToken,{client_iteration:this.config.client_iteration,client_published_at:this.config.published_at,user_data_failed:Boolean(this.store.get("user_data_failed")),user_data_generated_at:this.store.get("generated_at"),user_data_ip_address:this.store.get("user.ip_address"),user_data_visitor_token:this.store.get("user.token")})}track(e,t){switch(e){case K.QuestionnaireResponse:return this.apiClient.trackQuestionnaireResponse(t);case K.Conversion:return this.apiClient.trackConversion(t);case K.Event:return this.apiClient.trackEvent(t);case K.ExperienceImpression:{const e=t;return this.apiClient.trackExperienceImpression(Object.assign(Object.assign({},e),{selfOptimizingEventId:this.store.get(`web_experience_variation.${e.experience&&e.experience.id}.event_id`)}))}case K.Time:return this.apiClient.trackTime(t);case K.Metric:return this.apiClient.trackMetric(t)}}},R=(n(42),n(21),n(3));class D extends Error{static unknownError(){return new this(this.UNKNOWN)}static invalidResponse(e){return new this(`${this.INVALID_RESPONSE}: ${e}`)}}D.UNKNOWN="unknown",D.INVALID_RESPONSE="invalid response";var U;!function(e){e.Identify="identify",e.SegmentIdentify="segment_identify",e.Preview="preview",e.Impression="impression",e.ExperienceImpression="experience_impression",e.Conversion="conversion",e.QuestionnaireImpression="questionnaire_impression",e.QuestionnaireResponse="questionnaire_response",e.ImpressionEvent="impression_event",e.ImpressionTime="impression_time",e.Metric="metric",e.VisitorIdentification="visitor_identification"}(U||(U={}));n(23);var F=n(8);let H=0;(function(e){let t,n=H,r=!1})(()=>{const e=Object(R.d)(window.location.search).mutiny_preview;if(!e)return null;try{const t=JSON.parse(atob(e.split(".")[1]));return t||null}catch(e){return null}}),F.i,F.h,F.a,F.b,F.d;n(6);n(18);n(22);n(12);n(9);F.b,F.d,F.c;n(14),n(19),n(7);function B(e,t){return`https://app.mutinyhq.com/segments/${e}/experiences/${t}/edit`}class ${constructor(e,t,n,r,i){this.visitorToken=e,this.config=r,this.apiClient=i,this.logger=new o.a("segment-adapter"),this.queue=new c(()=>{var e;return Boolean(null===(e=window.analytics)||void 0===e?void 0:e.ready)})}identify(){this.queue.enqueue(()=>{window.analytics.ready(()=>{if(this.checkAnalyticsValid()){const e=window.analytics.user().id(),t=window.analytics.user().anonymousId();this.logger.info("Calling `segment.identify`"),window.analytics.identify({mutinyVisitorId:this.visitorToken}),this.apiClient.segmentIdentify(e,t)}})})}page(){}track(e,t){this.config.write_to_segment&&this.queue.enqueue(()=>{switch(e){case K.ExperienceImpression:return this.trackImpression(t);case K.QuestionnaireResponse:return this.trackQuestionnaireResponseSubmission(t);case K.Event:return this.trackEvent(t);default:return}})}trackEvent(e){switch(e.eventType){case r.k.QuestionnaireFormSubmitted:return this.trackQuestionnaireFormSubmission(e)}}trackImpression({impressionType:e,audienceSegment:t,experience:n}){this.apiClient.trackMetric({metricKey:"client.segment_track_impression.requested",metricType:r.n.Increment}),(t&&e===r.r.Personalized||e===r.r.Control)&&(this.apiClient.trackMetric({metricKey:"client.segment_track_impression.initiated",metricType:r.n.Increment}),window.analytics.ready(()=>{var i;this.apiClient.trackMetric({metricKey:"client.segment_track_impression.ready",metricType:r.n.Increment}),this.checkAnalyticsValid()&&t&&(this.logger.info("Calling `segment.track`"),window.analytics.track("Mutiny Experience Viewed",{audienceSegment:t.name,experience:n&&(n.name||B(t.id,n.id)),personalized:e===r.r.Personalized,variation:e===r.r.Personalized?null!==(i=null==n?void 0:n.variation_name)&&void 0!==i?i:"":r.r.Control}),this.apiClient.trackMetric({metricKey:"client.segment_track_impression.finished",metricType:r.n.Increment}))}))}trackQuestionnaireResponseSubmission({answers:e,questionnaire:t}){const n=e?e.reduce((e,{key:t,value:n})=>Object.assign(Object.assign({},e),{[t]:n}),{}):{};window.analytics.ready(()=>{this.checkAnalyticsValid()&&(this.logger.info("Calling `segment.track`"),window.analytics.track("Mutiny Questionnaire Completed",Object.assign(Object.assign({},n),{questionnaire:t.key})))})}trackQuestionnaireFormSubmission({metadata:{email:e,questionnaire_key:t}}){window.analytics.ready(()=>{this.checkAnalyticsValid()&&(this.logger.info("Calling `segment.track`"),window.analytics.track("Mutiny Questionnaire Completed",{email:e,questionnaire:t}))})}checkAnalyticsValid(){var e,t,n;return(null===(e=window.analytics)||void 0===e?void 0:e.user)?(null===(t=window.analytics)||void 0===t?void 0:t.identify)&&!!(null===(n=window.analytics)||void 0===n?void 0:n.track)||(this.apiClient.trackMetric({description:`No identify function (${this.config.company_slug}, ${this.visitorToken})`,metricKey:"Unexpected window.analytics object for Segment",metricType:r.n.Event}),!1):(this.apiClient.trackMetric({description:`No user function (${this.config.company_slug}, ${this.visitorToken})`,metricKey:"Unexpected window.analytics object for Segment",metricType:r.n.Event}),!1)}}var W=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};var V=class{constructor(e,t,n,r,i,o){this.visitorToken=e,this.userDataStore=n,this.clientMode=o}identify(){const e={visitorToken:this.visitorToken};window.mutinyData=e;const t=this.userDataStore.toJSON(),{user:n}=t,r=W(t,["user"]);window.mutiny.visitor={data:r,token:this.visitorToken},window.mutiny.experiences=[],window.mutiny.clientMode=this.clientMode}page(){window.mutiny.experiences=[]}track(e,t){switch(e){case K.ExperienceImpression:{const{impressionType:e,audienceSegment:n,experience:i}=t;if(n){const t={audienceSegment:null==n?void 0:n.name,experienceName:null==i?void 0:i.name,impressionType:e,personalized:e===r.r.Personalized,visitorToken:this.visitorToken};if(window.mutinyData=t,i){window.mutiny.experiences||(window.mutiny.experiences=[]);const t={audienceSegment:null==n?void 0:n.name,experience:null==i?void 0:i.name,impressionType:e,page:window.location.origin+window.location.pathname,variationKey:null==i?void 0:i.variation_key,variationName:null==i?void 0:i.variation_name};window.mutiny.experiences.push(t),window.dispatchEvent(new CustomEvent(r.h.WindowExperienceImpression,{detail:t}))}}return}default:return}}};var Q=class{constructor(e,t,n,r,i){this.apiClient=i}identify(){if(Object(R.d)(window.location.search).mtl)return this.apiClient.trackVisitorIdentification({identificationType:r.x.MutinyTrackedLink,value:window.location.href})}page(){}track(e,t){}};var K,J=class{constructor(){this.logger=new o.a("google-analytics-adapter"),this.queue=new c(()=>Boolean(window.ga&&window.ga.getAll&&window.ga.getAll().length>0))}identify(){}page(){}getEventLabelForPersonlization(e){return(null==e?void 0:e.variation_name)?`${r.r.Personalized} | ${e.variation_name}`:r.r.Personalized}getEventAction(e,t){return t?t.name?`${e.name} | ${t.name}`:`${e.name} | ${B(e.id,t.id)}`:e.name}track(e,t){this.queue.enqueue(()=>{window.ga(()=>{switch(e){case K.ExperienceImpression:{const e=t,n=e.audienceSegment,i=e.experience;if(n){this.logger.info("Calling `ga.send`");const t=e.impressionType===r.r.Personalized?this.getEventLabelForPersonlization(i):e.impressionType;for(const e of window.ga.getAll())e.send({eventAction:this.getEventAction(n,i),eventCategory:"mutinyExperienceQualify",eventLabel:t,hitType:"event",nonInteraction:!0})}break}}})})}};function G(e){switch(e){case r.i.Headless:return"headless";case r.i.Questionnaire:return"component";case r.i.Redirect:return"redirect";case r.i.Render:return"on_page"}}!function(e){e[e.Conversion=0]="Conversion",e[e.Time=1]="Time",e[e.QuestionnaireResponse=2]="QuestionnaireResponse",e[e.Event=3]="Event",e[e.ExperienceImpression=4]="ExperienceImpression",e[e.Metric=5]="Metric",e[e.VisitorIdentification=6]="VisitorIdentification"}(K||(K={}));var X=class{constructor(e,t,n,r,i){this.apiClient=i,this.logger=new o.a("google-analytics-4-adapter"),this.queue=new c(()=>Boolean(window.gtag))}identify(){}page(){}track(e,t){this.queue.enqueue(()=>{switch(e){case K.ExperienceImpression:{const e=t,n=e.audienceSegment,i=e.experience;n&&i?(this.logger.info("Calling gtag with mutinyExperienceQualify event"),window.gtag("event","mutiny_experience_impression",{experience_id:i.id,experience_name:i.name,experience_type:G(i.experience_type),segment_name:n.name,personalized:e.impressionType===r.r.Personalized,variation_name:i.variation_name,variation_key:i.variation_key}),this.apiClient.trackMetric({metricKey:"client.ga4_adapter.track.success",metricType:r.n.Increment})):this.apiClient.trackMetric({metricKey:"client.ga4_adapter.track.failed",metricType:r.n.Increment});break}}})}};var Y=class{constructor(e,t,n,r,i){this.apiClient=i,this.logger=new o.a("google-tag-manager-adapter"),this.queue=new c(()=>Boolean(window.dataLayer))}identify(){}page(){}track(e,t){this.queue.enqueue(()=>{switch(e){case K.ExperienceImpression:{const e=t,n=e.audienceSegment,i=e.experience;n&&i?(this.logger.info("Calling GTM with mutiny_experience_impression event"),window.dataLayer.push({event:"mutiny_experience_impression",experience_id:i.id,experience_name:i.name,experience_type:G(i.experience_type),segment_name:n.name,personalized:e.impressionType===r.r.Personalized,variation_name:i.variation_name,variation_key:i.variation_key}),this.apiClient.trackMetric({metricKey:"client.gtm_adapter.track.success",metricType:r.n.Increment})):this.apiClient.trackMetric({metricKey:"client.gtm_adapter.track.failed",metricType:r.n.Increment});break}}})}};const Z=[r.m.Mutiny,r.m.Window,r.m.MutinyTrackedLink];t.b=class{constructor(e,t,n,r,i,a,c,l){this.apiClient=e,this.trackingDisabled=a,this.preview=c,this.clientMode=l,this.logger=new o.a("data-exporter");const u=Object(s.c)(i.integrations.concat(Z));this.adapters=u.map(e=>{const o=this.getAdapter(e);return this.logger.debug(`Configuring ${e} adapter`),new o(t,n,r,i,this.apiClient,this.clientMode)})}identify(){if(this.trackingDisabled)this.preview?this.apiClient.trackPreview():this.logger.info("Skipping `identify` for doNotTrack mode");else{this.logger.info("Calling `identify`");for(const e of this.adapters)e.identify()}}page(){if(this.trackingDisabled)this.logger.info("Skipping `page` for doNotTrack mode");else{this.logger.info("Calling `page`");for(const e of this.adapters)e.page()}}track(e,t){return this.trackingDisabled?(this.logger.info("Skipping `track` for doNotTrack mode"),Promise.resolve()):(this.logger.info("Calling `track`",e,t),Promise.all(this.adapters.map(n=>Promise.resolve(n.track(e,t)))))}forceFlushQueues(){return Object(i.c)(()=>{var e;this.logger.info("Flushing API client queue");const t=this.apiClient.flush(!0);this.logger.info("Flushing all adapters",this.adapters);for(const t of this.adapters)null===(e=t.queue)||void 0===e||e.flush();return t})}disableTracking(){this.trackingDisabled=!0,this.apiClient.disableTracking()}getAdapter(e){switch(e){case r.m.Mutiny:return q;case r.m.Segment:return $;case r.m.Window:return V;case r.m.Amplitude:return u;case r.m.GoogleAnalytics:return J;case r.m.GoogleAnalytics4:return X;case r.m.GoogleTagManager:return Y;case r.m.Marketo:return f;case r.m.Hubspot:return h;case r.m.MutinyTrackedLink:return Q;default:throw new Error("Unknown integration type "+e)}}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));const r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,i=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[23]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;function o(){const e=navigator.userAgent||navigator.vendor;return r.test(e)||i.test(e.slice(0,4))}function s(){return o()?"mobile":"desktop"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r=(e,t=50,n)=>{let r=null,i=null;const o=void 0===(null==n?void 0:n.trailing)||(null==n?void 0:n.trailing);return(...n)=>{const s=Date.now();r||(i=s,e(...n));const a=t-(s-(i||0));a<=0||a>t?(r&&(window.clearTimeout(r),r=null),i=s,e(...n)):o&&(r=window.setTimeout(()=>e(...n),a))}},i=(e,t,n=1e3)=>{for(let r=0;r<n;r++){if(!e())return null;t()}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6);class i{constructor(){this.data={}}getItem(e){return this.data.hasOwnProperty(e)?this.data[e]:null}setItem(e,t){this.data[e]=t}}let o;function s(){return o||(o=!Object(r.d)()&&function(){try{return sessionStorage.setItem("test","test"),"test"!==sessionStorage.getItem("test")?!1:(sessionStorage.removeItem("test"),!0)}catch(e){return!1}}()?sessionStorage:new i,o)}},function(e,t,n){"use strict";function r(){var e,t;return(null===(e=document.querySelectorAll("script")[0])||void 0===e?void 0:e.nonce)||(null===(t=document.querySelectorAll("style")[0])||void 0===t?void 0:t.nonce)||""}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(2),n(8),n(0),n(1);var r=n(7),i=n(22);n(27);function o(e){const t=e=>{if(!e)return[];if("string"==typeof e){const t=[],n=new RegExp(r.a);let o=n.exec(e);return Object(i.b)(()=>!!o,()=>{t.push(o[1]),o=n.exec(e)}),t}return"object"==typeof e?Object.values(e).flatMap(e=>t(e)):[]};return new Set(t(e))}},function(e,t){e.exports="4.13.8-hackathon\n"},function(e,t,n){var r=n(30),i=n(31),o=n(32),s=n(33),a=n(34),c=n(35),l=n(36);l.alea=r,l.xor128=i,l.xorwow=o,l.xorshift7=s,l.xor4096=a,l.tychei=c,e.exports=l},,function(e,t){
/*! (c) Andrea Giammarchi @webreflection ISC */
!function(){"use strict";var e=function(e,t){var n=function(e){for(var t=0,n=e.length;t<n;t++)r(e[t])},r=function(e){var t=e.target,n=e.attributeName,r=e.oldValue;t.attributeChangedCallback(n,r,t.getAttribute(n))};return function(i,o){var s=i.constructor.observedAttributes;return s&&e(o).then((function(){new t(n).observe(i,{attributes:!0,attributeOldValue:!0,attributeFilter:s});for(var e=0,o=s.length;e<o;e++)i.hasAttribute(s[e])&&r({target:i,attributeName:s[e],oldValue:null})})),i}};function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw s}}}}
/*! (c) Andrea Giammarchi - ISC */var r="querySelectorAll",i="querySelectorAll",o=self,s=o.document,a=o.Element,c=o.MutationObserver,l=o.Set,u=o.WeakMap,d=function(e){return i in e},h=[].filter,f=function(e){var t=new u,o=function(n,r){var i;if(r)for(var o,s=function(e){return e.matches||e.webkitMatchesSelector||e.msMatchesSelector}(n),a=0,c=p.length;a<c;a++)s.call(n,o=p[a])&&(t.has(n)||t.set(n,new l),(i=t.get(n)).has(o)||(i.add(o),e.handle(n,r,o)));else t.has(n)&&(i=t.get(n),t.delete(n),i.forEach((function(t){e.handle(n,r,t)})))},f=function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,r=e.length;n<r;n++)o(e[n],t)},p=e.query,m=e.root||s,g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MutationObserver,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:["*"],s=function t(i,o,s,a,c,l){var u,d=n(i);try{for(d.s();!(u=d.n()).done;){var h=u.value;(l||r in h)&&(c?s.has(h)||(s.add(h),a.delete(h),e(h,c)):a.has(h)||(a.add(h),s.delete(h),e(h,c)),l||t(h[r](o),o,s,a,c,!0))}}catch(e){d.e(e)}finally{d.f()}},a=new i((function(e){if(o.length){var t,r=o.join(","),i=new Set,a=new Set,c=n(e);try{for(c.s();!(t=c.n()).done;){var l=t.value,u=l.addedNodes,d=l.removedNodes;s(d,r,i,a,!1,!1),s(u,r,i,a,!0,!1)}}catch(e){c.e(e)}finally{c.f()}}})),c=a.observe;return(a.observe=function(e){return c.call(a,e,{subtree:!0,childList:!0})})(t),a}(o,m,c,p),v=a.prototype.attachShadow;return v&&(a.prototype.attachShadow=function(e){var t=v.call(this,e);return g.observe(t),t}),p.length&&f(m[i](p)),{drop:function(e){for(var n=0,r=e.length;n<r;n++)t.delete(e[n])},flush:function(){for(var e=g.takeRecords(),t=0,n=e.length;t<n;t++)f(h.call(e[t].removedNodes,d),!1),f(h.call(e[t].addedNodes,d),!0)},observer:g,parse:f}},p=self,m=p.document,g=p.Map,v=p.MutationObserver,y=p.Object,b=p.Set,w=p.WeakMap,E=p.Element,k=p.HTMLElement,_=p.Node,O=p.Error,C=p.TypeError,x=p.Reflect,S=y.defineProperty,T=y.keys,A=y.getOwnPropertyNames,M=y.setPrototypeOf,j=!self.customElements,P=function(e){for(var t=T(e),n=[],r=new b,i=t.length,o=0;o<i;o++){n[o]=e[t[o]];try{delete e[t[o]]}catch(e){r.add(o)}}return function(){for(var o=0;o<i;o++)r.has(o)||(e[t[o]]=n[o])}};if(j){var N=function(){var e=this.constructor;if(!z.has(e))throw new C("Illegal constructor");var t=z.get(e);if(F)return B(F,t);var n=I.call(m,t);return B(M(n,e.prototype),t)},I=m.createElement,z=new g,L=new g,q=new g,R=new g,D=[],U=f({query:D,handle:function(e,t,n){var r=q.get(n);if(t&&!r.isPrototypeOf(e)){var i=P(e);F=M(e,r);try{new r.constructor}finally{F=null,i()}}var o="".concat(t?"":"dis","connectedCallback");o in r&&e[o]()}}).parse,F=null,H=function(e){if(!L.has(e)){var t,n=new Promise((function(e){t=e}));L.set(e,{$:n,_:t})}return L.get(e).$},B=e(H,v);self.customElements={define:function(e,t){if(R.has(e))throw new O('the name "'.concat(e,'" has already been used with this registry'));z.set(t,e),q.set(e,t.prototype),R.set(e,t),D.push(e),H(e).then((function(){U(m.querySelectorAll(e))})),L.get(e)._(t)},get:function(e){return R.get(e)},whenDefined:H},S(N.prototype=k.prototype,"constructor",{value:N}),self.HTMLElement=N,m.createElement=function(e,t){var n=t&&t.is,r=n?R.get(n):R.get(e);return r?new r:I.call(m,e)},"isConnected"in _.prototype||S(_.prototype,"isConnected",{configurable:!0,get:function(){return!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}else if(j=!self.customElements.get("extends-br"))try{var $=function e(){return self.Reflect.construct(HTMLBRElement,[],e)};$.prototype=HTMLLIElement.prototype;var W="extends-br";self.customElements.define("extends-br",$,{extends:"br"}),j=m.createElement("br",{is:W}).outerHTML.indexOf(W)<0;var V=self.customElements,Q=V.get,K=V.whenDefined;self.customElements.whenDefined=function(e){var t=this;return K.call(this,e).then((function(n){return n||Q.call(t,e)}))}}catch(e){}if(j){var J=function(e){var t=ne.get(e);de(t.querySelectorAll(this),e.isConnected)},G=self.customElements,X=m.createElement,Y=G.define,Z=G.get,ee=G.upgrade,te=(x||{construct:function(e){return e.call(this)}}).construct,ne=new w,re=new b,ie=new g,oe=new g,se=new g,ae=new g,ce=[],le=[],ue=function(e){return ae.get(e)||Z.call(G,e)},de=f({query:le,handle:function(e,t,n){var r=se.get(n);if(t&&!r.isPrototypeOf(e)){var i=P(e);ge=M(e,r);try{new r.constructor}finally{ge=null,i()}}var o="".concat(t?"":"dis","connectedCallback");o in r&&e[o]()}}).parse,he=f({query:ce,handle:function(e,t){ne.has(e)&&(t?re.add(e):re.delete(e),le.length&&J.call(le,e))}}).parse,fe=E.prototype.attachShadow;fe&&(E.prototype.attachShadow=function(e){var t=fe.call(this,e);return ne.set(this,t),t});var pe=function(e){if(!oe.has(e)){var t,n=new Promise((function(e){t=e}));oe.set(e,{$:n,_:t})}return oe.get(e).$},me=e(pe,v),ge=null;A(self).filter((function(e){return/^HTML.*Element$/.test(e)})).forEach((function(e){var t=self[e];function n(){var e=this.constructor;if(!ie.has(e))throw new C("Illegal constructor");var n=ie.get(e),r=n.is,i=n.tag;if(r){if(ge)return me(ge,r);var o=X.call(m,i);return o.setAttribute("is",r),me(M(o,e.prototype),r)}return te.call(this,t,[],e)}S(n.prototype=t.prototype,"constructor",{value:n}),S(self,e,{value:n})})),m.createElement=function(e,t){var n=t&&t.is;if(n){var r=ae.get(n);if(r&&ie.get(r).tag===e)return new r}var i=X.call(m,e);return n&&i.setAttribute("is",n),i},G.get=ue,G.whenDefined=pe,G.upgrade=function(e){var t=e.getAttribute("is");if(t){var n=ae.get(t);if(n)return void me(M(e,n.prototype),t)}ee.call(G,e)},G.define=function(e,t,n){if(ue(e))throw new O("'".concat(e,"' has already been defined as a custom element"));var r,i=n&&n.extends;ie.set(t,i?{is:e,tag:i}:{is:"",tag:e}),i?(r="".concat(i,'[is="').concat(e,'"]'),se.set(r,t.prototype),ae.set(e,t),le.push(r)):(Y.apply(G,arguments),ce.push(r=e)),pe(e).then((function(){i?(de(m.querySelectorAll(r)),re.forEach(J,[r])):he(m.querySelectorAll(r))})),oe.get(e)._(t)}}}()},function(e,t,n){(function(e){var r;!function(e,i,o){function s(e){var t,n=this,r=(t=4022871197,function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function c(e,t){var n=new s(e),r=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=c:n(11)&&n(17)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.alea=c}(0,e,n(11))}).call(this,n(16)(e))},function(e,t,n){(function(e){var r;!function(e,i,o){function s(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function c(e,t){var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=c:n(11)&&n(17)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.xor128=c}(0,e,n(11))}).call(this,n(16)(e))},function(e,t,n){(function(e){var r;!function(e,i,o){function s(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function c(e,t){var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=c:n(11)&&n(17)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.xorwow=c}(0,e,n(11))}).call(this,n(16)(e))},function(e,t,n){(function(e){var r;!function(e,i,o){function s(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function c(e,t){null==e&&(e=+new Date);var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.x&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=c:n(11)&&n(17)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.xorshift7=c}(0,e,n(11))}).call(this,n(16)(e))},function(e,t,n){(function(e){var r;!function(e,i,o){function s(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,o=t.i;return t.w=r=r+1640531527|0,n=i[o+34&127],e=i[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,i,o,s,a=[],c=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,c=Math.max(c,t.length)),i=0,o=-32;o<c;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,i=0==(n=a[127&o]^=r+s)?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;e.w=s,e.X=a,e.i=i}(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function c(e,t){null==e&&(e=+new Date);var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.X&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=c:n(11)&&n(17)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.xor4096=c}(0,e,n(11))}).call(this,n(16)(e))},function(e,t,n){(function(e){var r;!function(e,i,o){function s(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function c(e,t){var n=new s(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=c:n(11)&&n(17)?void 0===(r=function(){return c}.call(t,n,t,i))||(i.exports=r):this.tychei=c}(0,e,n(11))}).call(this,n(16)(e))},function(e,t,n){var r;!function(i,o,s){var a,c=s.pow(256,6),l=s.pow(2,52),u=2*l;function d(e,t,n){var r=[],d=p(function e(t,n){var r,i=[],o=typeof t;if(n&&"object"==o)for(r in t)try{i.push(e(t[r],n-1))}catch(e){}return i.length?i:"string"==o?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,m(o)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(256):(e=new Uint8Array(256),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,m(o)]}}():e,3),r),g=new h(r),v=function(){for(var e=g.g(6),t=c,n=0;e<l;)e=256*(e+n),t*=256,n=g.g(1);for(;e>=u;)e/=2,t/=2,n>>>=1;return(e+n)/t};return v.int32=function(){return 0|g.g(4)},v.quick=function(){return g.g(4)/4294967296},v.double=v,p(m(g.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&f(r,g),e.state=function(){return f(g,{})}),n?(s.random=e,t):e})(v,d,"global"in t?t.global:this==s,t.state)}function h(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);i<256;)s[i]=i++;for(i=0;i<256;i++)s[i]=s[o=255&o+e[i%n]+(t=s[i])],s[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,s=r.S;e--;)t=s[i=255&i+1],n=256*n+s[255&(s[i]=s[o=255&o+t])+(s[o]=t)];return r.i=i,r.j=o,n})(256)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){for(var n,r=e+"",i=0;i<r.length;)t[255&i]=255&(n^=19*t[255&i])+r.charCodeAt(i++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(p(s.random(),o),e.exports){e.exports=d;try{a=n(37)}catch(e){}}else void 0===(r=function(){return d}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof self?self:this,[],Math)},function(e,t){},function(e,t){!function(){"use strict";if("undefined"!=typeof document&&!("adoptedStyleSheets"in document)){var e="ShadyCSS"in window&&!ShadyCSS.nativeShadow,t=document.implementation.createHTMLDocument(""),n=new WeakMap,r="object"==typeof DOMException?Error:DOMException,i=Object.defineProperty,o=Array.prototype.forEach,s=/@import.+?;?$/gm,a=CSSStyleSheet.prototype;a.replace=function(){return Promise.reject(new r("Can't call replace on non-constructed CSSStyleSheets."))},a.replaceSync=function(){throw new r("Failed to execute 'replaceSync' on 'CSSStyleSheet': Can't call replaceSync on non-constructed CSSStyleSheets.")};var c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,h=S.prototype;h.replace=function(e){try{return this.replaceSync(e),Promise.resolve(this)}catch(e){return Promise.reject(e)}},h.replaceSync=function(e){if(x(this),"string"==typeof e){var t=this;c.get(t).textContent=function(e){var t=e.replace(s,"");return t!==e&&console.warn("@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418"),t.trim()}(e),d.set(t,[]),l.get(t).forEach((function(e){e.isConnected()&&C(t,O(t,e))}))}},i(h,"cssRules",{configurable:!0,enumerable:!0,get:function(){return x(this),c.get(this).sheet.cssRules}}),i(h,"media",{configurable:!0,enumerable:!0,get:function(){return x(this),c.get(this).sheet.media}}),["addRule","deleteRule","insertRule","removeRule"].forEach((function(e){h[e]=function(){var t=this;x(t);var n=arguments;d.get(t).push({method:e,args:n}),l.get(t).forEach((function(r){if(r.isConnected()){var i=O(t,r).sheet;i[e].apply(i,n)}}));var r=c.get(t).sheet;return r[e].apply(r,n)}})),i(S,Symbol.hasInstance,{configurable:!0,value:k});var f={childList:!0,subtree:!0},p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap;if(N.prototype={isConnected:function(){var e=m.get(this);return e instanceof Document?"loading"!==e.readyState:function(e){return"isConnected"in e?e.isConnected:document.contains(e)}(e.host)},connect:function(){var e=j(this);v.get(this).observe(e,f),g.get(this).length>0&&P(this),M(e,(function(e){T(e).connect()}))},disconnect:function(){v.get(this).disconnect()},update:function(e){var t=this,n=m.get(t)===document?"Document":"ShadowRoot";if(!Array.isArray(e))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+n+": Iterator getter is not callable.");if(!e.every(k))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+n+": Failed to convert value to 'CSSStyleSheet'");if(e.some(_))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+n+": Can't adopt non-constructed stylesheets");t.sheets=e;var r,i,o=g.get(t),s=(r=e).filter((function(e,t){return r.indexOf(e)===t}));(i=s,o.filter((function(e){return-1===i.indexOf(e)}))).forEach((function(e){var n;(n=O(e,t)).parentNode.removeChild(n),function(e,t){u.get(e).delete(t),l.set(e,l.get(e).filter((function(e){return e!==t})))}(e,t)})),g.set(t,s),t.isConnected()&&s.length>0&&P(t)}},window.CSSStyleSheet=S,A(Document),"ShadowRoot"in window){A(ShadowRoot);var y=Element.prototype,b=y.attachShadow;y.attachShadow=function(e){var t=b.call(this,e);return"closed"===e.mode&&n.set(this,t),t}}var w=T(document);w.isConnected()?w.connect():document.addEventListener("DOMContentLoaded",w.connect.bind(w))}function E(e){return e.shadowRoot||n.get(e)}function k(e){return"object"==typeof e&&(h.isPrototypeOf(e)||a.isPrototypeOf(e))}function _(e){return"object"==typeof e&&a.isPrototypeOf(e)}function O(e,t){return u.get(e).get(t)}function C(e,t){requestAnimationFrame((function(){t.textContent=c.get(e).textContent,d.get(e).forEach((function(e){return t.sheet[e.method].apply(t.sheet,e.args)}))}))}function x(e){if(!c.has(e))throw new TypeError("Illegal invocation")}function S(){var e=document.createElement("style");t.body.appendChild(e),c.set(this,e),l.set(this,[]),u.set(this,new WeakMap),d.set(this,[])}function T(e){var t=p.get(e);return t||(t=new N(e),p.set(e,t)),t}function A(e){i(e.prototype,"adoptedStyleSheets",{configurable:!0,enumerable:!0,get:function(){return T(this).sheets},set:function(e){T(this).update(e)}})}function M(e,t){for(var n=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT,(function(e){return E(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),null,!1),r=void 0;r=n.nextNode();)t(E(r))}function j(e){var t=m.get(e);return t instanceof Document?t.body:t}function P(e){var t=document.createDocumentFragment(),n=g.get(e),r=v.get(e),i=j(e);r.disconnect(),n.forEach((function(n){t.appendChild(O(n,e)||function(e,t){var n=document.createElement("style");return u.get(e).set(t,n),l.get(e).push(t),n}(n,e))})),i.insertBefore(t,null),r.observe(i,f),n.forEach((function(t){C(t,O(t,e))}))}function N(t){var n=this;n.sheets=[],m.set(n,t),g.set(n,[]),v.set(n,new MutationObserver((function(t,r){document?t.forEach((function(t){e||o.call(t.addedNodes,(function(e){e instanceof Element&&M(e,(function(e){T(e).connect()}))})),o.call(t.removedNodes,(function(t){t instanceof Element&&(function(e,t){return t instanceof HTMLStyleElement&&g.get(e).some((function(t){return O(t,e)}))}(n,t)&&P(n),e||M(t,(function(e){T(e).disconnect()})))}))})):r.disconnect()})))}}()},function(e,t,n){"use strict";n.r(t),n.d(t,"wrapEditorDomUpdates",(function(){return de})),n.d(t,"attachEditorInterface",(function(){return he}));var r=n(2),i=n(1);function o(e){var t;return e.nodeType===e.COMMENT_NODE||e instanceof HTMLElement&&(!!(null===(t=e.dataset)||void 0===t?void 0:t.mutiny)||e.isMutinyElement)}function s({target:e,addedNodes:t,removedNodes:n,type:r}){const i=e,s=Array.from(t).concat(Array.from(n));return"childList"!==r?o(i):s.length>0&&s.every(e=>e&&o(e))}var a=n(0);const c=new i.a("reconcilliation-monitoring");let l,u,d=!1;function h(){var e;l=document.cloneNode(!0),u=new WeakMap,function e(t,n){if(null==u||u.set(t,n),n.childNodes.length>0)for(let r=0;r<n.childNodes.length;r++)e(t.childNodes[r],n.childNodes[r])}(l,document);for(const t of Array.from(l.querySelectorAll("mutiny-personalization"))){const n=t.querySelector("mutiny-variation[control]");if(n){const r=document.createDocumentFragment();for(const e of Array.from(n.childNodes))r.append(e);null===(e=t.parentNode)||void 0===e||e.replaceChild(r,t)}else t.remove()}for(const e of Array.from(l.querySelectorAll("[data-mutiny],[data-mutiny-root]")))e.remove()}function f(e,t="independent"){if("legacy"===t)return document.querySelectorAll(e);const n=(l||h(),l);return Array.from(n.querySelectorAll(e)).map(e=>null==u?void 0:u.get(e)).filter(e=>!!e)}function p(e,t="independent"){var n,r;return null!==(r=null===(n=f(e,t))||void 0===n?void 0:n[0])&&void 0!==r?r:null}var m=n(20);var g=class{constructor(e,t){this.callback=e,this.connected=!1,this.callbackCount=0,this.firstCallbackAt=void 0,this.observer=new MutationObserver(this.wrappedCallback.bind(this)),this.callbackLimit=void 0===(null==t?void 0:t.callbackLimit)?100:t.callbackLimit,this.exporter=null==t?void 0:t.exporter,this.domUpdateId=null==t?void 0:t.domUpdateId,this.logger=null==t?void 0:t.logger}observe(e,t){var n;this.connected=!0,null===(n=this.logger)||void 0===n||n.info("Observing mutations on new node",e),this.observer.observe(e,t||{})}disconnect(){var e;this.connected=!1,null===(e=this.logger)||void 0===e||e.info("Unsubscribing mutation observer from new changes"),this.observer.disconnect()}takeRecords(){return this.observer.takeRecords()}wrappedCallback(e){var t,n,r;if(this.connected)return(void 0===this.firstCallbackAt||performance.now()-this.firstCallbackAt>=1e3)&&(this.firstCallbackAt=performance.now(),this.callbackCount=0),this.callback(e,this.observer)&&(this.callbackCount+=1,null===(n=this.logger)||void 0===n||n.debug("Executed WrappedMutationObserver callback",{callbackCount:this.callbackCount,callbackLimit:this.callbackLimit})),this.shouldDisconnect()?(this.disconnect(),void(null===(r=this.exporter)||void 0===r||r.track(m.a.Metric,{description:this.domUpdateId?"DOM Update ID: "+this.domUpdateId:"No DOM Update ID provided",metricKey:"Client DOM Update MutationObserver Limit Exceeded",metricType:a.n.Event}))):void 0;null===(t=this.logger)||void 0===t||t.error("Mutation observer callback triggered while not connected")}shouldDisconnect(){var e;return!!(this.callbackCount>=this.callbackLimit&&this.firstCallbackAt&&performance.now()-this.firstCallbackAt<1e3)&&(null===(e=this.logger)||void 0===e||e.warn("Disconnecting WrappedMutationObserver because exceeded per second callback limit",{callbackCount:this.callbackCount,callbackLimit:this.callbackLimit}),!0)}};const v={characterData:!0,childList:!0,subtree:!0};var y=class{constructor(e,t,n,r="update-renderer",o){this.personalize=e,this.domUpdates=t,this.domEvents=n,this.type=r,this.exporter=o,this.listeners=[],this.logger=new i.a(r)}get isUpdateRenderer(){return"update-renderer"===this.type}onRender(e){this.logger.info("attaching renderListener",e),this.listeners.push(e)}renderAsync(){return this.logger.info("renderAsync called, queuing requestAnimationFrame with",this.domUpdates),new Promise(e=>{requestAnimationFrame(()=>{this.logger.info("requestAnimationFrame executing"),this.render(),this.attachBodyObserver(),e(!0)})})}render(){return this.withErrorHandlingAndTracking(()=>{if(this.logger.info("Starting DOMRenderer render"),document.body&&this.personalize)for(const e of this.domUpdates)e.render();for(const e of this.domEvents)e.setup();for(const e of this.listeners)this.logger.info("Running render callbacks"),e();const e=this.domUpdates.filter(e=>e.isRendered()),t=this.domUpdates.filter(e=>!e.shouldRender()),n=this.domUpdates.filter(e=>e.shouldRender()&&!e.isRendered());return this.isUpdateRenderer&&document.dispatchEvent(new CustomEvent(a.h.DomRendererComplete,{detail:{renderedRecords:e.map(e=>e.record),unrenderedRecords:n.map(e=>e.record)}})),this.logger.info("Finished DOMRenderer render. Rendered elements: ",e),this.logger.info("Finished DOMRenderer render. Skipped elements: ",t),this.logger.info("Finished DOMRenderer render. Missing elements: ",n),e})}withErrorHandlingAndTracking(e){return Object(r.c)(()=>e())}teardown(){this.logger.info("Tearing down DOMRenderer"),this.observer&&this.observer.disconnect();for(const e of this.domUpdates)e.teardown();for(const e of this.domEvents)e.teardown()}attachBodyObserver(){this.logger.info("attaching MutationObserver to document",document),this.observer?this.observer.disconnect():this.observer=new g(e=>{const t=e.every(e=>s(e));if(!this.isUpdateRenderer||!t){this.logger.info("Mutation observed from DOMRenderer",e),l=null;const t=this.domUpdates.filter(e=>"modification"===e.record.personalization_type);for(const e of t)!e.isOriginalPresent()&&e.isRendered()&&e.teardown();for(const e of this.domEvents)!e.isOriginalRendered()&&e.isAttached()&&e.teardown();return this.render(),this.exporter&&function(e,t){var n;if(!d)for(const r of e)r.target instanceof HTMLElement&&["__next","___gatsby","root","__nuxt"].includes(r.target.id)&&0!==(null!==(n=r.removedNodes)&&void 0!==n?n:[]).length&&(Array.from(r.target.children).some(e=>!o(e))||(d=!0,c.error("Detected possible reconcilliation failure."),t.apiClient.trackMetric({metricKey:"client.monitor.application_fatal_unrender",metricType:a.n.Increment,tags:{client_version:"4.13.8-hackathon"}})))}(e,this.exporter),!0}return this.logger.info("Ignoring mutations from Mutiny client",e),!1},{callbackLimit:200,logger:this.logger}),this.observer.observe(document,v)}isListening(){var e;return Boolean(null===(e=this.observer)||void 0===e?void 0:e.connected)}},b=n(14),w=n(25),E=n(7),k=n(10),_=n(24);var O=new class{constructor(){this.hasRunMapping={},this.customJavascriptStore={},this.logger=new i.a("custom-js-service")}getCustomJavascriptWrapperName(e){var t;return`mutinyJS${e.resource_id.replaceAll("-","")}${e.custom_javascript?null===(t=e.custom_javascript)||void 0===t?void 0:t.id.replaceAll("-",""):""}`}attachCustomJavascript(e,t,n){var r;const i=Object(k.a)("script");i.nonce=Object(_.a)(),i.setAttribute("type","text/javascript"),i.setAttribute("id",e);const o=`function ${e}(element, hasRunBefore) { ${n} }`;i.innerHTML=o,document.head.append(i),null===(r=this.logger)||void 0===r||r.info("Attaching custom javascript to element:",t,i),this.customJavascriptStore[e]=window[e]}runCustomJavascript(e,t,n,r){var i,o,s,a;if(t.custom_javascript){const c=this.getCustomJavascriptWrapperName(t);let l=this.customJavascriptStore[c];const u=Boolean(l);l||(this.hasRunMapping[t.custom_javascript.id]=!1,this.attachCustomJavascript(c,e,t.custom_javascript.custom_javascript_string),l=this.customJavascriptStore[c]);try{null===(i=this.logger)||void 0===i||i.info("Running custom javascript with element:",e,l),l(e,this.hasRunMapping[t.custom_javascript.id]),this.hasRunMapping[t.custom_javascript.id]=!0,null==r||r(t.custom_javascript.id,u)}catch(i){this.hasRunMapping[t.custom_javascript.id]=!0,this.logger.warn("Error in custom javascript with element",e,l);const c=i,d=null!==(a=null===(s=null===(o=null==c?void 0:c.message)||void 0===o?void 0:o.toString)||void 0===s?void 0:s.call(o))&&void 0!==a?a:"Error thrown in element-level js";null==r||r(t.custom_javascript.id,u,d),n(t.custom_javascript.custom_javascript_string,d,c)}}}};const C=(e,t)=>{const n=(i=t,Z(r=e)?null===(o=r.interactiveClone)||void 0===o?void 0:o.getOriginalOfClonedElement(i):void 0);var r,i,o;const s=n||t;return s.parentElement?te(s.parentElement).indexOf(s):-1},x=new Set(["animate","animateMotion","animateTransform","circle","clippath","color-profile","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","hatch","hatchpath","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","solidcolor","stop","svg","switch","symbol","text","textPath","title","tspan","unknown","use","view"]),S={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};class T{constructor(e){this.userData=e,this.renderedNodes=new WeakSet,this.logger=new i.a("node-renderer")}renderNode(e){let t;if("fragment"===e.tag)t=document.createDocumentFragment();else if(x.has(e.tag)){t=document.createElementNS("http://www.w3.org/2000/svg",e.tag);for(const n of Object.keys(e.html_attributes))if("xmlns"!==n){const r=n.split(":")[0];if(r)t.setAttributeNS(S[r],n,Object(E.c)(e.html_attributes[n],this.userData));else{const r=this.buildAttrNode(n,Object(E.c)(e.html_attributes[n],this.userData));r&&t.setAttributeNode(r)}}}else{t=Object(k.a)(e.tag),t.dataset.mutiny="true";for(const n of Object.keys(e.html_attributes))try{const r=this.buildAttrNode(n,Object(E.c)(e.html_attributes[n],this.userData));if(!r)throw new Error(`Could not build attribute node for attribute "${n}"`);t.setAttributeNode(r)}catch(e){this.logger.error("Failed to set HTML attribute",e)}}for(const n of e.inner_html)if("string"==typeof n){const e=document.createTextNode(Object(E.c)(n,this.userData));this.renderedNodes.add(e),t.append(e)}else{const e=this.renderNode(n);t.append(e)}return this.renderedNodes.add(t),t}buildAttrNode(e,t){var n,r;const i=null===(n=(new DOMParser).parseFromString(`<div id="tmp" ${e} />`,"text/html").querySelector("#tmp"))||void 0===n?void 0:n.getAttributeNode(e);return t&&i&&(i.value=t),null!==(r=null==i?void 0:i.cloneNode(!0))&&void 0!==r?r:null}}var A=(e,t,n)=>{const r=new T(n),i=r.renderNode(t.content);return e.innerHTML="",e.append(i),r.renderedNodes};const M=Element.prototype.getBoundingClientRect;Element.prototype.getBoundingClientRect=function(){const e=ie.getClonedElement(this);return M.call(null!=e?e:this)};const j={display:"none"},P={};var N=class{constructor(e,t){this.originalStyles={},this.hidden=!1,this.element=e,t&&(P[t]=this),this.hide(),this.mutationObserver=new MutationObserver(()=>{this.forEachReservedStyle(t=>{e.style[t]!==j[t]&&this.hidden&&(this.originalStyles[t]=e.style[t],this.element.style.setProperty(t,j[t],"important"))})}),this.mutationObserver.observe(e,{attributes:!0,attributeFilter:["style"]})}hide(){this.hidden=!0,this.forEachReservedStyle(e=>{this.originalStyles[e]=this.element.style[e],this.element.style.setProperty(e,j[e],"important")})}show(){this.hidden=!1,this.forEachReservedStyle(e=>{var t;return this.element.style.setProperty(e,null!==(t=this.originalStyles[e])&&void 0!==t?t:"")})}forEachReservedStyle(e){for(const t of Object.keys(j))e(t)}};let I;let z=!1;try{window.addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){z={passive:!0}}}))}catch(e){}n(38);const L=CSSStyleSheet.prototype.insertRule,q=CSSStyleSheet.prototype.deleteRule,R=CSSStyleSheet.prototype.replace,D=CSSStyleSheet.prototype.replaceSync;class U extends CSSStyleSheet{insertRule(...e){return L.call(this,...e)}deleteRule(...e){return q.call(this,...e)}replace(...e){return R.call(this,...e)}replaceSync(...e){return D.call(this,...e)}}function F(e){const t=new U,n=t.insertRule(`tmp { ${e} }`),r=t.cssRules[null!=n?n:0];return function(e){return e.type===CSSRule.STYLE_RULE}(r)?r:void 0}function H(e,t){var n,r,i;const o=F(null!==(n=t.getAttribute("style"))&&void 0!==n?n:""),s=F(e),a=new Set(Array.from(null!==(r=null==s?void 0:s.style)&&void 0!==r?r:[])),c=Array.from(null!==(i=null==o?void 0:o.style)&&void 0!==i?i:[]).filter(e=>!a.has(e));for(const e of c)t.style.removeProperty(e);if(s)for(const e of Array.from(s.style))t.style.setProperty(e,s.style.getPropertyValue(e),s.style.getPropertyPriority(e))}function B(e){return[HTMLInputElement,HTMLSelectElement,HTMLOptionElement].some(t=>e instanceof t)}function $(e){return e instanceof HTMLAnchorElement}class W{constructor(e,t,n){var r;this.styleSheet=new U,this.cloneToOriginal=new WeakMap,this.originalToClone=new WeakMap,this.mutationListeners=[],this.cloneToOriginalNodes=new WeakMap,this.originalToCloneNodes=new WeakMap,this.options=Object.assign({cloneMutations:!0},n),this.originalElement=e,this.personalization=t,this.logger=new i.a("InteractiveClone:"+(null===(r=t.record)||void 0===r?void 0:r.resource_id))}initialize(){this.clone(this.originalElement),this.updateElementMapping(),this.mutationObserver=new MutationObserver(e=>{for(const t of e)switch(t.type){case"attributes":this.handleAttributeMutation(t);break;case"characterData":this.handleCharacterDataMutation(t);break;case"childList":this.handleChildListMutation(t)}for(const t of this.mutationListeners)t(this.personalization,this.originalElement,e);return!0}),this.mutationObserver.observe(this.originalElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0})}teardown(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect()}addMutationListener(e){this.mutationListeners.push(e)}removeNestedPersonalization(e){const t=this.cloneToOriginal.get(e);if(!t)return;this.cloneToOriginal.delete(e);const n=this.clone(t);n&&(this.originalToClone.set(t,n),this.cloneToOriginal.set(n,t))}handleChildListMutation(e){var t;if(!this.options.cloneMutations)return;for(const n of Array.from(e.removedNodes)){if(n instanceof HTMLElement?!this.originalToClone.has(n):!this.originalToCloneNodes.has(n))continue;const e=n instanceof HTMLElement?this.originalToClone.get(n):this.originalToCloneNodes.get(n);null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}const n=this.originalToClone.get(e.target),r=null===e.nextSibling?null:e.nextSibling instanceof HTMLElement?this.originalToClone.get(e.nextSibling):this.originalToCloneNodes.get(e.nextSibling);for(const t of Array.from(e.addedNodes)){if(ie.getContainingPersonalizationForElement(t)!==this.personalization)continue;const e=t instanceof HTMLElement&&Z(t),i=e?t:t.cloneNode(!0);if(e){if(e&&!ee(t)){const e=t.originalElement;if(!e)continue;const r=this.originalToClone.get(e);if(!r)continue;this.logger.debug("Detected a personalization being added to the original tree. Replacing:",r,"with personalization:",t),null==n||n.replaceChild(t,r),this.updateElementMapping(e,t)}}else null==n||n.insertBefore(i,null!=r?r:null),this.updateElementMapping(t,i)}}handleAttributeMutation(e){if(!(e.target instanceof HTMLElement&&e.attributeName))return;if(e.target===this.originalElement)return this.cloneAttribute(e.attributeName,this.originalElement,this.personalization),void this.personalization.attributeChangeCallback(e.attributeName,e.oldValue,this.personalization.getAttribute(e.attributeName));if(!this.options.cloneMutations)return;const t=this.originalToClone.get(e.target);if(t){if(Z(t))return;this.cloneAttribute(e.attributeName,e.target,t)}}handleCharacterDataMutation(e){var t;if(!this.options.cloneMutations)return;const n=this.originalToCloneNodes.get(e.target);if(!n)return;const r=e.target.cloneNode(!0);null===(t=n.parentNode)||void 0===t||t.replaceChild(r,n),this.updateElementMapping(e.target,r)}clone(e){var t;if(e===this.originalElement){for(const e of this.originalElement.getAttributeNames())this.cloneAttribute(e,this.originalElement,this.personalization),this.personalization.attributeChangeCallback(e,null,this.originalElement.getAttribute(e));const e=[];for(const t of Array.from(this.originalElement.childNodes))e.push(t.cloneNode(!0));return this.personalization.innerHTML="",void this.personalization.append(...e)}const n=this.originalToClone.get(e);if(!n)return;const r=e.cloneNode(!0);return null===(t=n.parentElement)||void 0===t||t.replaceChild(r,n),r}updateElementMapping(e,t){var n;e||t||(this.cloneToOriginal=new WeakMap,this.originalToClone=new WeakMap,this.cloneToOriginalNodes=new WeakMap,this.originalToCloneNodes=new WeakMap);const r=new Set,i=[],o=new Set;let s=!0;this.traverseTreeWith((e,t)=>{var n;ee(e)&&o.add(e);const a=ie.getPersonalizationForElement(e);return a&&a!==this.personalization?(t!==a&&(i.push({replace:t,withElement:a}),ee(a)&&o.add(a)),ee(a)||(this.cloneToOriginal.set(a,e),this.originalToClone.set(e,a)),"break"):Z(t)&&t!==this.personalization&&!(null===(n=t.isRendered)||void 0===n?void 0:n.call(t))?(r.add(t),"break"):(t.dataset.mutiny="true",this.elementMatches(e,t)||(s=!1),s&&(this.cloneToOriginal.set(t,e),this.originalToClone.set(e,t)),"continue")},e,t);for(const e of r)e.remove();for(const{replace:e,withElement:t}of i)null===(n=e.parentElement)||void 0===n||n.replaceChild(t,e);for(const e of o)e.placePersonalization();s||e||t||(this.cloneToOriginal=new WeakMap,this.originalToClone=new WeakMap,this.cloneToOriginalNodes=new WeakMap,this.originalToCloneNodes=new WeakMap)}traverseTreeWith(e,t,n){const r=(t,n)=>{var i,o,s,a;if(t instanceof HTMLElement||n instanceof HTMLElement||(this.originalToCloneNodes.set(t,n),this.cloneToOriginalNodes.set(n,t)),!(t instanceof HTMLElement&&n instanceof HTMLElement&&"break"===e(t,n)))for(let e=0;e<n.childNodes.length;e++){const c=null===(o=null===(i=null==t?void 0:t.childNodes)||void 0===i?void 0:i.item)||void 0===o?void 0:o.call(i,e),l=null===(a=null===(s=null==n?void 0:n.childNodes)||void 0===s?void 0:s.item)||void 0===a?void 0:a.call(s,e);c&&l&&r(c,l)}};r(null!=t?t:this.originalElement,null!=n?n:this.personalization)}elementMatches(e,t){return["tagName","id"].every(n=>e[n]===t[n])&&e.children.length===t.children.length}getOriginalOfClonedElement(e){return this.cloneToOriginal.get(e)}cloneAttribute(e,t,n){var r;if("style"===e)return void H(null!==(r=t.getAttribute("style"))&&void 0!==r?r:"",n);const i=t.getAttributeNode(e);i?n.setAttributeNode(i.cloneNode(!0)):n.removeAttribute(e)}}for(const e of function(){if(I)return I;const e=new Set(["click","dblclick","keydown","keypress","keyup","scroll"]);for(const t of[HTMLElement,HTMLFormElement,HTMLInputElement,HTMLMediaElement,HTMLVideoElement,HTMLCanvasElement,HTMLSelectElement])for(const n of Object.keys(t.prototype).filter(e=>e.startsWith("on")))e.add(n.slice(2));return I=Array.from(e.values()),I}()){const t=["scroll","wheel","mousewheel","touch","drag"].some(t=>e.startsWith(t));window.addEventListener(e,e=>{var n,r;if(!(e.target instanceof HTMLElement))return;const i=ie.getPersonalizationForNode(e.target);if(!i)return;const o=null===(n=i.element)||void 0===n?void 0:n.cloneToOriginal.get(e.target);if(o){if(!t){let t=e.target,n=0;for(;null!==t&&t!==i&&n++<100&&!$(t);)t=t.parentElement;if(t instanceof HTMLElement&&$(t)){const n=Z(t)?t.originalElement:null===(r=i.element)||void 0===r?void 0:r.cloneToOriginal.get(t);if($(n)){if(t.href!==n.href)return;e.preventDefault()}}}B(o)&&B(e.target)&&e.target.value!==o.value&&(o.value=e.target.value),null==o||o.dispatchEvent(new e.constructor(e.type,e))}},!t||Object.assign(Object.assign({},z),{capture:!0}))}const V="style";var Q=(e,t,n,r)=>{var o;const s=new i.a("AttributeApplier:"+t.id);for(const i of Object.keys(t.html_attributes))if("class"!==i||t.replace_classes)(c=i).startsWith("data-mutiny")||[V].includes(c)?(s.warn("Received HTML style attributes in AttributeApplier"),null===(o=null==r?void 0:r.exporter)||void 0===o||o.track(m.a.Metric,{description:`DOM Update ID: ${t.id}; Attribute: ${i}`,metricKey:"Client DOM Update contains blacklisted attribute",metricType:a.n.Event})):e.setAttribute(i,Object(E.c)(t.html_attributes[i],n));else{const r=Object(E.c)(t.html_attributes[i],n).split(/\s+/g).filter(e=>e.length>0);for(const t of r)e.classList.add(t)}var c};var K=(e,t,n)=>{H(Object(E.c)(t.cssText,n),e)},J=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const G=e=>`mutiny-${e.toLowerCase()}-personalization`,X=new Map,Y=new Set,Z=e=>{var t,n,r,i;return!!e&&(null!==(r=null!==(t=e.isMutinyElement)&&void 0!==t?t:(i=null!==(n=e.getAttribute("is"))&&void 0!==n?n:"",/^mutiny-[\da-z-]+-personalization$/.test(i)))&&void 0!==r&&r)},ee=e=>{var t;return Z(e)&&!!(null===(t=e.record)||void 0===t?void 0:t.data.position)},te=e=>Array.from(e.children).reduce((t,n)=>(n===e||Z(n)||t.push(n),t),new Array),ne=e=>class extends e{constructor(){super(),this.initialized=!1,this.rendered=!1,this.tearingDown=!1,this.logger=new i.a("mutiny-personalization"),this.reattachedCounter=0,this.mutationObserver=new g(e=>{var t,n,r,i,o,c,l,u,d;if(!this.isRendered())return!1;if((null===(n=null===(t=this.record)||void 0===t?void 0:t.data)||void 0===n?void 0:n.content)&&(null===(i=null===(r=this.record)||void 0===r?void 0:r.data)||void 0===i?void 0:i.render_only_once))return!1;this.logger.info("Mutations observed",e);const h=e.filter(e=>!s(e));if(this.logger.info("Non mutiny mutations observed",h),0===h.length)return!0;null===(o=this.exporter)||void 0===o||o.apiClient.trackMetric({metricKey:"client.mutation.observed.personalization",metricType:a.n.Increment});const{record:f,userData:p}=this.getContext(),m=!!f.data.content;let g=!1;const v=[];for(const e of h)if("childList"===e.type)for(const t of Array.from(e.addedNodes))"modification"===f.personalization_type&&ie.getPersonalizationForNode(t)!==this||(m?(null===(c=this.contentChangeNodes)||void 0===c?void 0:c.has(t))||(g=!0):"modification"!==f.personalization_type||(t instanceof HTMLElement?null===(l=this.element)||void 0===l?void 0:l.cloneToOriginal.has(t):null===(u=this.element)||void 0===u?void 0:u.cloneToOriginalNodes.has(t))||(v.push(t),null===(d=t.parentNode)||void 0===d||d.removeChild(t)));return g&&f.data.content&&(this.contentChangeNodes=A(this,{id:f.resource_id,content:f.data.content},p),this.executeCustomJs(),this.logger.info("Clearing mutations from content update:",this.mutationObserver.takeRecords())),this.logger.info("Removed non mutiny nodes",v),!0},{callbackLimit:10,disconnectCallback:()=>{this.teardown()}}),this.mutationObserver.observe(this,{childList:!0,subtree:!0});try{this.root=this.attachShadow({mode:"closed"});const e=Object(k.a)("slot");e.style.setProperty("box-sizing","inherit"),this.root.append(e)}catch(e){this.logger.log("Element type cannot be used as shadow root. Falling back to rendering personalization within the main tree.")}}get isMutinyElement(){return!0}get nodeName(){return window.__MUTINY_DISABLE_PERSONALIZATION_MASKING?super.nodeName:"MUTINY-"+super.nodeName}get nodeType(){return window.__MUTINY_DISABLE_PERSONALIZATION_MASKING?super.nodeType:Node.COMMENT_NODE}initializePersonalization(e,t,n,r,o,s){this.initialized?this.logger.error("Attempted to initialize the same personalization more than once."):(this.logger=new i.a("mutiny-personalization:"+t.resource_id),this.originalElement=e,this.record=t,this.userData=n,this.exporter=o,this.mutinyParentElement=r,this.onCustomJsExecuted=s,this.render(),this.initialized=!0)}isRendered(){return this.rendered&&this.isConnected}render(){var e,t;const{record:n,userData:r}=this.getContext(),{remove:i,content:o}=n.data;if(!this.rendered){if(this.rendered=!0,"addition"===n.personalization_type&&ie.registerAdditionPersonalization(this),!this.element&&"addition"!==n.personalization_type){if(!this.originalElement)throw new Error("could not retrieve original element");if(ie.registerPersonalization(this.originalElement,this),i)return void(this.elementHider=new N(this.originalElement,n.selector));this.element=new W(this.originalElement,this,{cloneMutations:!o}),this.element.initialize(),"addition"!==(null===(e=this.record)||void 0===e?void 0:e.personalization_type)&&(this.elementHider=new N(this.originalElement,n.selector))}o&&(this.contentChangeNodes=A(this,{id:n.resource_id,content:o},r),null===(t=this.element)||void 0===t||t.updateElementMapping()),this.applyAttributePersonalization(),this.executeCustomJs(),this.logger.info("Clearing mutations resulting from render:",this.mutationObserver.takeRecords())}}placePersonalization(){var e,t,n,r;const{record:{data:{position:i},personalization_type:o},originalElement:s}=this.getContext();(null===(e=this.getParentPersonalization())||void 0===e?void 0:e.contains(this))&&(null===(n=null===(t=this.getParentPersonalization())||void 0===t?void 0:t.element)||void 0===n||n.removeNestedPersonalization(this));const a=this.getTargetPositionParent();if(i&&a){const e=((e,t,n,r)=>{var i,o;const s=Array.from(n.children);for(const a of s)if(("modification"!==r||a!==e.originalElement)&&a!==e)if(Z(a)&&(null===(i=a.record)||void 0===i?void 0:i.data.position)){const e=a.record.data.position;if(e.index>=t.index&&e.deconflictor>=t.deconflictor)return a}else if(Z(a)&&(null===(o=a.originalElement)||void 0===o?void 0:o.parentElement)){if(te(a.originalElement.parentElement).indexOf(a.originalElement)>=t.index)return a}else if(C(n,a)>=t.index)return a;return null})(this,i,a,o);this.logger.debug("Placing personalization:",this,"within:",a,"before:",e),a.insertBefore(this,e)}else this.logger.debug("Placing personalization:",this,"after original element:",s),null===(r=null==s?void 0:s.parentElement)||void 0===r||r.insertBefore(this,s.nextSibling)}teardown(){var e,t,n,r,i;if(!this.rendered)return;this.tearingDown=!0,null===(e=this.element)||void 0===e||e.teardown(),this.rendered=!1,ie.unregisterPersonalization(this),null===(t=this.elementHider)||void 0===t||t.show();const o=this.getContext().record.data.position&&this.getTargetPositionParent();(null===(n=this.getParentPersonalization())||void 0===n?void 0:n.contains(this))&&!o&&(null===(i=null===(r=this.getParentPersonalization())||void 0===r?void 0:r.element)||void 0===i||i.removeNestedPersonalization(this)),this.remove()}attributeChangeCallback(e,t,n){var r,i,o,s;const{record:a}=this.getContext(),{html_attributes:c,styles:l}=a.data;if("style"===e)for(const e of Object.keys(null!==(i=null===(r=this.elementHider)||void 0===r?void 0:r.originalStyles)&&void 0!==i?i:{}))this.style.setProperty(e,null!==(s=null===(o=this.elementHider)||void 0===o?void 0:o.originalStyles[e])&&void 0!==s?s:"");(Object.keys(null!=c?c:{}).includes(e)||"style"===e&&l)&&this.applyAttributePersonalization()}disconnectedCallback(){requestAnimationFrame(()=>{var e,t;if(!this.isConnected&&!this.isNested())if(!this.initialized||this.tearingDown||"addition"!==(null===(e=this.record)||void 0===e?void 0:e.personalization_type)&&!(null===(t=this.element)||void 0===t?void 0:t.originalElement.isConnected))ie.unregisterPersonalization(this),this.rendered=!1;else{if(this.reattachedCounter>=100)return this.logger.error("Attempted to reattach more times than the permitted limit.",this),ie.unregisterPersonalization(this),void(this.rendered=!1);this.logger.warn("Personalization was disconnected premmaturely. Attempting to reattach.",this),this.placePersonalization(),this.reattachedCounter++}})}executeCustomJs(){const{record:e}=this.getContext();O.runCustomJavascript(this,e,(e,t,n)=>{var r,i,o;null===(r=this.exporter)||void 0===r||r.apiClient.trackMetric({description:t,metricKey:"element-level js error",metricType:a.n.Event,tags:{name:null!==(i=null==n?void 0:n.name)&&void 0!==i?i:"",message:t,stack:null!==(o=null==n?void 0:n.stack)&&void 0!==o?o:"",code:e}})},this.onCustomJsExecuted)}getTargetPositionParent(){const e=this.mutinyParentElement&&ie.getClonedElement(this.mutinyParentElement);return null!=e?e:this.mutinyParentElement}getParentPersonalization(){return this.parentElement?ie.getPersonalizationForNode(this.parentElement):null}isNested(){var e,t;return null!==(t=null===(e=this.getParentPersonalization())||void 0===e?void 0:e.isRendered())&&void 0!==t&&t}get interactiveClone(){return this.element}get replacedStyleAttribute(){var e,t,n,r;if("addition"===(null===(e=this.record)||void 0===e?void 0:e.personalization_type))return null!==(t=this.getAttribute("style"))&&void 0!==t?t:void 0;if(!this.originalElement)return;if(!this.elementHider)return null!==(n=this.originalElement.getAttribute("style"))&&void 0!==n?n:void 0;const i=this.originalElement.cloneNode(!1);for(const[e,t]of Object.entries(this.elementHider.originalStyles))t&&i.style.setProperty(e,t);return null!==(r=i.getAttribute("style"))&&void 0!==r?r:void 0}applyAttributePersonalization(){const{record:e,userData:t}=this.getContext(),{html_attributes:n,styles:r,replace_classes:i}=e.data,o=n||{},{style:s}=o,a=J(o,["style"]),c=[r?Object.entries(r).map(e=>e.join(": ")).join("; "):"",s].filter(Boolean).join("; ");a&&Q(this,{id:e.resource_id,html_attributes:a,replace_classes:i},t,{exporter:this.exporter}),K(this,{id:e.resource_id,cssText:c},t)}getContext(){if(!this.record||!this.userData||"addition"!==this.record.personalization_type&&!this.originalElement)throw this.logger.error("Attempted to call getContext on MutinyPersonalization prior to initializing"),new Error("initializePersonalization must be called prior to interacting with personalizations");return{record:this.record,userData:this.userData,originalElement:this.originalElement}}};ne(HTMLElement);function re(e){if(function(e){const t=G(e),n=Object(k.a)(e);if(Y.has(t))return!1;if(X.has(t))return!0;const i=Object.getPrototypeOf(n).constructor,o=ne(i);try{customElements.define(t,o,{extends:n.tagName.toLowerCase()}),X.set(t,o)}catch(e){return function(e){return"object"==typeof e&&null!==e&&"code"in e&&"number"==typeof e.message}(e)&&e.code===DOMException.NOT_SUPPORTED_ERR&&r.b.notify(e),Y.add(t),!1}return!0}(e))return G(e)}var ie=new class{constructor(){this.elementRegistry=new WeakMap,this.elementAdditionRegistry=new Map,this.registeredPersonalizations=new Set}getPersonalizationForElement(e){return this.elementRegistry.get(e)}getAdditionForElement(e){return this.elementAdditionRegistry.get(e)}getContainingPersonalizationForElement(e){var t;let n=e,r=0;for(;n!==document.body;){if(r++,r>1e3)return null;const e=null!==(t=n instanceof HTMLElement&&this.elementRegistry.get(n))&&void 0!==t?t:void 0;if(e)return e;if(!n.parentElement)return null;n=n.parentElement}return null}getPersonaizationForNode(e){return this.getPersonalizationForNode(e)}getPersonalizationForNode(e){let t=e,n=0;for(;t!==document.body;){if(n++,n>1e3)return null;if(t instanceof Element&&Z(t)&&this.registeredPersonalizations.has(t))return t;if(!t.parentElement)return null;t=t.parentElement}return null}getOriginalElement(e){var t;const n=this.getPersonalizationForNode(e);if(n)return null===(t=n.element)||void 0===t?void 0:t.cloneToOriginal.get(e)}getClonedElement(e){var t;const n=this.getContainingPersonalizationForElement(e);if(n)return null===(t=n.element)||void 0===t?void 0:t.originalToClone.get(e)}getPersonalizations(){return Array.from(this.registeredPersonalizations.values())}registerPersonalization(e,t){e&&this.elementRegistry.set(e,t),this.registeredPersonalizations.add(t)}registerAdditionPersonalization(e){const{record:t}=e;t&&this.elementAdditionRegistry.set(t.resource_id,e),this.registeredPersonalizations.add(e)}unregisterPersonalization(e){var t,n;if("addition"!==(null===(t=e.record)||void 0===t?void 0:t.personalization_type)){const t=e;t.originalElement&&this.elementRegistry.get(t.originalElement)===e&&this.elementRegistry.delete(t.originalElement)}"addition"===(null===(n=e.record)||void 0===n?void 0:n.personalization_type)&&this.elementAdditionRegistry.delete(e.record.resource_id),this.registeredPersonalizations.delete(e)}};const oe=globalThis.IntersectionObserver,se=[];class ae extends oe{constructor(e,t){super(ae.wrappedCallback(e),t),this.targets=new Set,se.push(this)}observe(e){if(!(e instanceof HTMLElement))return this.targets.add(e),super.observe(e);const t=ie.getClonedElement(e);return this.targets.add(null!=t?t:e),super.observe(null!=t?t:e)}unobserve(e,t=!1){if(!(e instanceof HTMLElement)||t)return this.targets.delete(e),super.unobserve(e);const n=ie.getClonedElement(e);return this.targets.delete(null!=n?n:e),super.unobserve(null!=n?n:e)}static wrappedCallback(e){return(t,n)=>{const r=t.map(e=>{if(!(e.target instanceof HTMLElement))return e;const t=ie.getOriginalElement(e.target);return t?Object.assign(Object.assign({},this.copyIntersectionObserverEntry(e)),{target:t}):e});e(r,n)}}static copyIntersectionObserverEntry(e){const t=Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter(e=>"constructor"!==e),n={};for(const r of t){const t=r;n[t]=e[t]}return n}}globalThis.IntersectionObserver=ae;class ce{constructor(e,t,n,r,o){this.record=e,this.userData=t,this.exporter=n,this.preview=r,this.onCustomJsExecuted=o,this.logger=new i.a("dom-update")}isRendered(){var e,t;return null!==(t=null===(e=this.personalization)||void 0===e?void 0:e.isRendered())&&void 0!==t&&t}isOriginalPresent(){var e;return!!(null===(e=this.personalization)||void 0===e?void 0:e.originalElement)&&document.contains(this.personalization.originalElement)}shouldRender(){const e=this.preview===a.s.Editor,t=Array.from(Object(w.a)(this.record)),n=t.every(e=>null!==this.userData.get(e));return n||this.logger.warn("Found invalid content dependencies.",t.filter(e=>null===this.userData.get(e))),(e||n)&&Object(b.b)(this.record.condition,this.userData)}render(){var e,t,n,r,i,o,s,c,l,u,d,h,f;if(this.isRendered()||!this.shouldRender())return;null===(e=this.personalization)||void 0===e||e.teardown();const p=this.getElement();if(!p)return;if(!(p instanceof HTMLElement))return this.logger.warn("Attempted to personalize a non-HTMLElement. Skipping rendering."),void(null===(t=this.exporter)||void 0===t||t.apiClient.trackMetric({description:`Personalization illegally targets a non-HTMLElement (${this.record.resource_id})`,metricKey:"client.rendering.invalid_personalization_target",metricType:a.n.Event}));if("modification"===this.record.personalization_type&&(null===(n=ie.getPersonalizationForElement(p))||void 0===n?void 0:n.isRendered()))return this.logger.warn("Skipping rendering of 'modification' personalization targetting an already personalized element."),void(null===(r=this.exporter)||void 0===r||r.apiClient.trackMetric({description:`Personalization targetted element already personalized by another personalization (${this.record.resource_id})`,metricKey:"Duplicate target within personalization detected",metricType:a.n.Event}));const m="addition"===this.record.personalization_type;if(m&&(null===(i=ie.getAdditionForElement(this.record.resource_id))||void 0===i?void 0:i.isRendered()))return this.logger.warn("Skipping rendering of 'addition' personalization targetting an already personalized element."),void(null===(o=this.exporter)||void 0===o||o.apiClient.trackMetric({description:`Personalization targetted element already personalized by another personalization (${this.record.resource_id})`,metricKey:"Duplicate target within personalization detected",metricType:a.n.Event}));if(m){if(!this.record.data.tag)return this.logger.error("Skipping rendering of 'addition' personalization because it has no tag."),void(null===(s=this.exporter)||void 0===s||s.apiClient.trackMetric({description:`Addition personalization has no tag and cannot render (${this.record.resource_id})`,metricKey:"Addition personalization has no tag",metricType:a.n.Event}));if(!this.record.data.position)return this.logger.error("Skipping rendering of 'addition' personalization because it has no position."),void(null===(c=this.exporter)||void 0===c||c.apiClient.trackMetric({description:`Addition personalization has no position and cannot render (${this.record.resource_id})`,metricKey:"Addition personalization has no position",metricType:a.n.Event}))}const g=m?re(this.record.data.tag):re(p.tagName);if(!g)return;if((e=>Object.entries(j).every(([t,n])=>e.style[t]===n))(p)){const e=P[this.record.selector];if(e)for(const t of Object.keys(j))p.style.setProperty(t,null!==(l=e.originalStyles[t])&&void 0!==l?l:"")}for(const e of Array.from(null!==(d=null===(u=p.parentElement)||void 0===u?void 0:u.querySelectorAll(":scope > "+g))&&void 0!==d?d:[]))e.remove();for(const e of Array.from(null!==(f=null===(h=p.parentElement)||void 0===h?void 0:h.querySelectorAll(`:scope > [data-mutiny-id="${this.record.resource_id}"]`))&&void 0!==f?f:[]))e.remove();let v;if(this.personalization=Object(k.a)(m?this.record.data.tag:p.tagName.toLowerCase(),{is:g}),this.personalization.dataset.mutinyRoot="true",this.personalization.dataset.mutinyId=this.record.resource_id,this.personalization.dataset.mutinyAddition=String(m),!this.record.data.position||(v=this.getElement(this.record.data.position.parent_selector)||void 0,v)){this.personalization.initializePersonalization(m?void 0:p,this.record,this.userData,v,this.exporter,this.onCustomJsExecuted),this.personalization.placePersonalization();for(const e of se)for(const t of Array.from(e.targets.values()))t instanceof HTMLElement&&ie.getContainingPersonalizationForElement(t)===this.personalization&&(e.unobserve(t,!0),e.observe(t))}}teardown(){var e;null===(e=this.personalization)||void 0===e||e.teardown()}getElement(e=this.record.selector){var t;return null!==(t=Array.from(f(e,this.record.selectorMode)).find(e=>!this.record.content_hash||Number(this.record.content_hash)===Object(E.b)(e.innerHTML)))&&void 0!==t?t:null}}var le=n(8),ue=n(18);function de(e,t={},n){return e.map(e=>new ce(e,new le.g(t,new ue.a),void 0,a.s.Editor,n))}function he(){window.mutinyEditor||(window.mutinyEditor={DOMRenderer:y,isMutinyElement:Z,getAllOriginalChildren:te,loadQuestionnaireInterface:()=>Promise.all([n.e(1),n.e(6)]).then(n.bind(null,61)).then(({default:e})=>n.e(4).then(n.bind(null,43)).then(({render:t,h:r})=>{let i=document.querySelector("#mutiny-preact");return i||(i=Object(k.a)("div"),i.setAttribute("id","mutiny-preact"),document.body.append(i)),t(r(e,{}),i),n.e(5).then(n.bind(null,60))})),personalizationRegistry:ie,querySelector:p,querySelectorAll:f,wrapDomUpdates:de})}he()},,,function(e,t,n){"use strict";var r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i;const o=new Uint8Array(16);function s(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function c(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}t.a=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();const i=(e=e||{}).random||(e.rng||s)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return c(i)}}]);